// -*-C++-*-

/* Purpose: NCO/ncap2 script to process and calibrate Terraref exposure data

   Documentation:
   https://docs.google.com/document/d/1w_zHHlrPVKsy1mnW9wrVzAU2edVqZH8i1IZa5BZxVpo/edit#heading=h.jjfbhbos05cc # Calibration employed since 20160908
   https://github.com/terraref/computing-pipeline/issues/88 # Calibration employed until 20160908

   Usage:
   ncap2 -v -O -S ~/terraref/computing-pipeline/scripts/hyperspectral/hyperspectral_calibration.nco ${DATA}/terraref/whiteReference_raw.nc ~/foo.nc */

// Declare flags as RAM variables or they will clutter output file
*flg_tst=1s; // [flg] Test mode
*flg_prd=0s; // [flg] Production mode
*flg_vnir=0s; // [flg] VNIR image
*flg_swir=0s; // [flg] SWIR image

// Run in test or production mode?
*flg_typ=flg_prd; // [enm] Run type

// Defaults for values not provided on command-line
if(!exists(clb_nbr)) *clb_nbr=73; // [nbr] Calibration number

// Add georeferenced coordinates
// Store x and y in double-precision in case we use lat/lon
// If stored as meters from image or gantry corner, then single-precision would be sufficient
x=array(0.0,0.001,$x);
x@long_name="North-south offset from start position";
x@units="meter";
x@algorithm="CSZ implemented these fake data to be replaced by real formula once available.";

y=array(0.0,0.00098526434004512529576754637665,$y);
y@long_name="East-west offset from start position";
y@units="meter";
y@algorithm="Based on https://github.com/terraref/computing-pipeline/issues/144. y is defined as 0.9853 mm per pixel. Exact number is 0.98526434004512529576754637665 mm.";
  
// Change Hyperspectral Imager wavelengths from nm to m (SI)
wavelength*=1.0e-9; // [m]
wavelength@standard_name="radiation_wavelength";  
wavelength@units="meter";  

// [W m-2 m-1] Downwelling spectral irradiance
// 20160908 This is a placeholder for irradiance on the hyperspectral grid 
// Currently no instrument measures this
// The only irradiance measured in by the Environmental Logger, which has a different (and non-overlapping) spectral grid
//flx_dwn[wavelength]=2.0e9f;
//flx_dwn@long_name="Downwelling spectral irradiance";
//flx_dwn@standard_name="surface_downwelling_radiative_flux_per_unit_wavelength_in_air";
//flx_dwn@units="watt meter-2 meter-1"; 

/* Calibrate hyperspectral image from raw counts to reflectance
   Optimal calibration would have this equal 2^16-1 in each channel for a perfectly white reflector
   This parameter depends solely on the bit-resolution of the camera (currently 16 bits) */
*exposure_theoretical_maximum=ushort(2^16-1); // [cnt]

/* Assume spectral reference target employed is "white" reference sheet that reflects all wavelengths with 95% efficiency
   (Some) Documentation for spectralon reference targets at
   https://github.com/terraref/reference-data/issues/36
   https://github.com/terraref/reference-data/issues/53

   20160927: fxm replace guesstimate with actual, wavelength-dependent calibrated reflectance below */
*factory_calibrated_reflectance_guesstimate=0.95f; // [frc]

/* 20161005 */
if(min(wavelength < 0.5e-6)){
  flg_vnir=1s;
  *wvl_pxl_nbr=2160;
 }else{
  flg_swir=1s;
  *wvl_pxl_nbr=288;
 } // !wavelength
// [nbr] Number of pixels in factory calibration of Spectralon reference
defdim("wvl_pxl",wvl_pxl_nbr);
wvl_pxl[wvl_pxl]=0.0f; // [m]
wvl_pxl@standard_name="sensor_band_central_radiation_wavelength";
wvl_pxl@units="meter";
wvl_pxl@provenance="Tino Dornbusch posted spreadsheet with wavelengths that correspond to each pixel in VNIR, SWIR calibration images to https://github.com/terraref/reference-data/issues/53 on 20160927.
   Accompanying note says: Attached the spectral response of VNIR (G4-384) and SWIR (G4-383) we have got from headwall which corresponds to the certificate.";

if(flg_vnir){
  wvl_pxl@long_name="Wavelength corresponding to each pixel in VNIR calibration";
  /* Data are 2160 wavelengths (for pixels 0-2159) between 3--1385 nm
     More information at https://github.com/terraref/reference-data/issues/53 */
  wvl_pxl[wvl_pxl]={ // [nm] 10 wavelengths per line, 2160 total
    3.10054618499521,3.74041016817614,4.38027415135696,5.02013813453789,5.66000211771870,6.29986610089964,6.93973008408045,7.57959406726138,8.21945805044220,8.85932203362313,
    9.49918601680406,10.1390499999849,10.7789139831658,11.4187779663466,12.0586419495276,12.6985059327084,13.3383699158893,13.9782338990701,14.6180978822510,15.2579618654319,
    15.8978258486128,16.5376898317936,17.1775538149745,17.8174177981554,18.4572817813363,19.0971457645171,19.7370097476980,20.3768737308789,21.0167377140598,21.6566016972406,
    22.2964656804215,22.9363296636024,23.5761936467833,24.2160576299641,24.8559216131450,25.4957855963258,26.1356495795068,26.7755135626876,27.4153775458685,28.0552415290493,
    28.6951055122303,29.3349694954111,29.9748334785920,30.6146974617728,31.2545614449538,31.8944254281346,32.5342894113155,33.1741533944964,33.8140173776773,34.4538813608581,
    35.0937453440390,35.7336093272199,36.3734733104008,37.0133372935816,37.6532012767625,38.2930652599434,38.9329292431242,39.5727932263051,40.2126572094860,40.8525211926669,
    41.4923851758477,42.1322491590286,42.7721131422095,43.4119771253904,44.0518411085713,44.6917050917522,45.3315690749330,45.9714330581139,46.6112970412948,47.2511610244757,
    47.8910250076565,48.5308889908374,49.1707529740183,49.8106169571992,50.4504809403800,51.0903449235609,51.7302089067418,52.3700728899227,53.0099368731035,53.6498008562844,
    54.2896648394653,54.9295288226461,55.5693928058270,56.2092567890079,56.8491207721888,57.4889847553696,58.1288487385505,58.7687127217314,59.4085767049123,60.0484406880931,
    60.6883046712740,61.3281686544549,61.9680326376358,62.6078966208166,63.2477606039975,63.8876245871784,64.5274885703593,65.1673525535401,65.8072165367210,66.4470805199019,
    67.0869445030827,67.7268084862637,68.3666724694446,69.0065364526254,69.6464004358063,70.2862644189872,70.9261284021680,71.5659923853489,72.2058563685298,72.8457203517107,
    73.4855843348915,74.1254483180724,74.7653123012533,75.4051762844342,76.0450402676150,76.6849042507959,77.3247682339768,77.9646322171577,78.6044962003385,79.2443601835194,
    79.8842241667003,80.5240881498812,81.1639521330620,81.8038161162429,82.4436800994238,83.0835440826046,83.7234080657855,84.3632720489664,85.0031360321473,85.6430000153281,
    86.2828639985090,86.9227279816899,87.5625919648708,88.2024559480516,88.8423199312325,89.4821839144134,90.1220478975943,90.7619118807752,91.4017758639561,92.0416398471369,
    92.6815038303178,93.3213678134987,93.9612317966796,94.6010957798604,95.2409597630413,95.8808237462222,96.5206877294031,97.1605517125839,97.8004156957648,98.4402796789457,
    99.0801436621265,99.7200076453074,100.359871628488,100.999735611669,101.639599594850,102.279463578031,102.919327561212,103.559191544393,104.199055527574,104.838919510754,
    105.478783493935,106.118647477116,106.758511460297,107.398375443478,108.038239426659,108.678103409840,109.317967393021,109.957831376201,110.597695359382,111.237559342563,
    111.877423325744,112.517287308925,113.157151292106,113.797015275287,114.436879258468,115.076743241648,115.716607224829,116.356471208010,116.996335191191,117.636199174372,
    118.276063157553,118.915927140734,119.555791123915,120.195655107095,120.835519090276,121.475383073457,122.115247056638,122.755111039819,123.394975023000,124.034839006181,
    124.674702989362,125.314566972542,125.954430955723,126.594294938904,127.234158922085,127.874022905266,128.513886888447,129.153750871628,129.793614854809,130.433478837989,
    131.073342821170,131.713206804351,132.353070787532,132.992934770713,133.632798753894,134.272662737075,134.912526720256,135.552390703436,136.192254686617,136.832118669798,
    137.471982652979,138.111846636160,138.751710619341,139.391574602522,140.031438585703,140.671302568883,141.311166552064,141.951030535245,142.590894518426,143.230758501607,
    143.870622484788,144.510486467969,145.150350451150,145.790214434330,146.430078417511,147.069942400692,147.709806383873,148.349670367054,148.989534350235,149.629398333416,
    150.269262316597,150.909126299777,151.548990282958,152.188854266139,152.828718249320,153.468582232501,154.108446215682,154.748310198863,155.388174182044,156.028038165224,
    156.667902148405,157.307766131586,157.947630114767,158.587494097948,159.227358081129,159.867222064310,160.507086047491,161.146950030671,161.786814013852,162.426677997033,
    163.066541980214,163.706405963395,164.346269946576,164.986133929757,165.625997912938,166.265861896118,166.905725879299,167.545589862480,168.185453845661,168.825317828842,
    169.465181812023,170.105045795204,170.744909778385,171.384773761565,172.024637744746,172.664501727927,173.304365711108,173.944229694289,174.584093677470,175.223957660651,
    175.863821643832,176.503685627012,177.143549610193,177.783413593374,178.423277576555,179.063141559736,179.703005542917,180.342869526098,180.982733509279,181.622597492459,
    182.262461475640,182.902325458821,183.542189442002,184.182053425183,184.821917408364,185.461781391545,186.101645374726,186.741509357906,187.381373341087,188.021237324268,
    188.661101307449,189.300965290630,189.940829273811,190.580693256992,191.220557240173,191.860421223353,192.500285206534,193.140149189715,193.780013172896,194.419877156077,
    195.059741139258,195.699605122439,196.339469105620,196.979333088800,197.619197071981,198.259061055162,198.898925038343,199.538789021524,200.178653004705,200.818516987886,
    201.458380971067,202.098244954247,202.738108937428,203.377972920609,204.017836903790,204.657700886971,205.297564870152,205.937428853333,206.577292836514,207.217156819694,
    207.857020802875,208.496884786056,209.136748769237,209.776612752418,210.416476735599,211.056340718780,211.696204701961,212.336068685141,212.975932668322,213.615796651503,
    214.255660634684,214.895524617865,215.535388601046,216.175252584227,216.815116567408,217.454980550588,218.094844533769,218.734708516950,219.374572500131,220.014436483312,
    220.654300466493,221.294164449674,221.934028432855,222.573892416035,223.213756399216,223.853620382397,224.493484365578,225.133348348759,225.773212331940,226.413076315121,
    227.052940298302,227.692804281482,228.332668264663,228.972532247844,229.612396231025,230.252260214206,230.892124197387,231.531988180568,232.171852163749,232.811716146929,
    233.451580130110,234.091444113291,234.731308096472,235.371172079653,236.011036062834,236.650900046015,237.290764029196,237.930628012376,238.570491995557,239.210355978738,
    239.850219961919,240.490083945100,241.129947928281,241.769811911462,242.409675894643,243.049539877823,243.689403861004,244.329267844185,244.969131827366,245.608995810547,
    246.248859793728,246.888723776909,247.528587760090,248.168451743270,248.808315726451,249.448179709632,250.088043692813,250.727907675994,251.367771659175,252.007635642356,
    252.647499625537,253.287363608717,253.927227591898,254.567091575079,255.206955558260,255.846819541441,256.486683524622,257.126547507803,257.766411490984,258.406275474164,
    259.046139457345,259.686003440526,260.325867423707,260.965731406888,261.605595390069,262.245459373250,262.885323356431,263.525187339611,264.165051322792,264.804915305973,
    265.444779289154,266.084643272335,266.724507255516,267.364371238697,268.004235221878,268.644099205058,269.283963188239,269.92382717142,270.563691154601,271.203555137782,
    271.843419120963,272.483283104144,273.123147087325,273.763011070505,274.402875053686,275.042739036867,275.682603020048,276.322467003229,276.962330986410,277.602194969591,
    278.242058952772,278.881922935953,279.521786919133,280.161650902314,280.801514885495,281.441378868676,282.081242851857,282.721106835038,283.360970818219,284.000834801399,
    284.640698784580,285.280562767761,285.920426750942,286.560290734123,287.200154717304,287.840018700485,288.479882683666,289.119746666846,289.759610650027,290.399474633208,
    291.039338616389,291.67920259957,292.319066582751,292.958930565932,293.598794549113,294.238658532293,294.878522515474,295.518386498655,296.158250481836,296.798114465017,
    297.437978448198,298.077842431379,298.717706414560,299.357570397740,299.997434380921,300.637298364102,301.277162347283,301.917026330464,302.556890313645,303.196754296826,
    303.836618280007,304.476482263187,305.116346246368,305.756210229549,306.396074212730,307.035938195911,307.675802179092,308.315666162273,308.955530145454,309.595394128634,
    310.235258111815,310.875122094996,311.514986078177,312.154850061358,312.794714044539,313.434578027720,314.074442010901,314.714305994081,315.354169977262,315.994033960443,
    316.633897943624,317.273761926805,317.913625909986,318.553489893167,319.193353876348,319.833217859529,320.473081842709,321.112945825890,321.752809809071,322.392673792252,
    323.032537775433,323.672401758614,324.312265741795,324.952129724976,325.591993708156,326.231857691337,326.871721674518,327.511585657699,328.151449640880,328.791313624061,
    329.431177607242,330.071041590423,330.710905573603,331.350769556784,331.990633539965,332.630497523146,333.270361506327,333.910225489508,334.550089472689,335.189953455869,
    335.829817439050,336.469681422231,337.109545405412,337.749409388593,338.389273371774,339.029137354955,339.669001338136,340.308865321316,340.948729304497,341.588593287678,
    342.228457270859,342.868321254040,343.508185237221,344.148049220402,344.787913203583,345.427777186763,346.067641169944,346.707505153125,347.347369136306,347.987233119487,
    348.627097102668,349.266961085849,349.906825069030,350.546689052210,351.186553035391,351.826417018572,352.466281001753,353.106144984934,353.746008968115,354.385872951296,
    355.025736934477,355.665600917658,356.305464900838,356.945328884019,357.585192867200,358.225056850381,358.864920833562,359.504784816743,360.144648799924,360.784512783105,
    361.424376766285,362.064240749466,362.704104732647,363.343968715828,363.983832699009,364.623696682190,365.263560665371,365.903424648552,366.543288631732,367.183152614913,
    367.823016598094,368.462880581275,369.102744564456,369.742608547637,370.382472530818,371.022336513999,371.662200497179,372.302064480360,372.941928463541,373.581792446722,
    374.221656429903,374.861520413084,375.501384396265,376.141248379446,376.781112362626,377.420976345807,378.060840328988,378.700704312169,379.340568295350,379.980432278531,
    380.620296261712,381.260160244893,381.900024228073,382.539888211254,383.179752194435,383.819616177616,384.459480160797,385.099344143978,385.739208127159,386.379072110340,
    387.018936093520,387.658800076701,388.298664059882,388.938528043063,389.578392026244,390.218256009425,390.858119992606,391.497983975786,392.137847958967,392.777711942148,
    393.417575925329,394.057439908510,394.697303891691,395.337167874872,395.977031858053,396.616895841233,397.256759824414,397.896623807595,398.536487790776,399.176351773957,
    399.816215757138,400.456079740319,401.095943723500,401.735807706681,402.375671689861,403.015535673042,403.655399656223,404.295263639404,404.935127622585,405.574991605766,
    406.214855588947,406.854719572128,407.494583555308,408.134447538489,408.774311521670,409.414175504851,410.054039488032,410.693903471213,411.333767454394,411.973631437575,
    412.613495420755,413.253359403936,413.893223387117,414.533087370298,415.172951353479,415.812815336660,416.452679319841,417.092543303022,417.732407286202,418.372271269383,
    419.012135252564,419.651999235745,420.291863218926,420.931727202107,421.571591185288,422.211455168469,422.851319151649,423.491183134830,424.131047118011,424.770911101192,
    425.410775084373,426.050639067554,426.690503050735,427.330367033916,427.970231017096,428.610095000277,429.249958983458,429.889822966639,430.529686949820,431.169550933001,
    431.809414916182,432.449278899363,433.089142882543,433.729006865724,434.368870848905,435.008734832086,435.648598815267,436.288462798448,436.928326781629,437.568190764810,
    438.208054747990,438.847918731171,439.487782714352,440.127646697533,440.767510680714,441.407374663895,442.047238647076,442.687102630257,443.326966613437,443.966830596618,
    444.606694579799,445.246558562980,445.886422546161,446.526286529342,447.166150512523,447.806014495704,448.445878478884,449.085742462065,449.725606445246,450.365470428427,
    451.005334411608,451.645198394789,452.285062377970,452.924926361151,453.564790344331,454.204654327512,454.844518310693,455.484382293874,456.124246277055,456.764110260236,
    457.403974243417,458.043838226598,458.683702209778,459.323566192959,459.963430176140,460.603294159321,461.243158142502,461.883022125683,462.522886108864,463.162750092045,
    463.802614075225,464.442478058406,465.082342041587,465.722206024768,466.362070007949,467.001933991130,467.641797974311,468.281661957492,468.921525940672,469.561389923853,
    470.201253907034,470.841117890215,471.480981873396,472.120845856577,472.760709839758,473.400573822939,474.040437806119,474.680301789300,475.320165772481,475.960029755662,
    476.599893738843,477.239757722024,477.879621705205,478.519485688386,479.159349671566,479.799213654747,480.439077637928,481.078941621109,481.718805604290,482.358669587471,
    482.998533570652,483.638397553833,484.278261537013,484.918125520194,485.557989503375,486.197853486556,486.837717469737,487.477581452918,488.117445436099,488.757309419280,
    489.397173402460,490.037037385641,490.676901368822,491.316765352003,491.956629335184,492.596493318365,493.236357301546,493.876221284727,494.516085267907,495.155949251088,
    495.795813234269,496.435677217450,497.075541200631,497.715405183812,498.355269166993,498.995133150174,499.634997133354,500.274861116535,500.914725099716,501.554589082897,
    502.194453066078,502.834317049259,503.474181032440,504.114045015621,504.753908998801,505.393772981982,506.033636965163,506.673500948344,507.313364931525,507.953228914706,
    508.593092897887,509.232956881068,509.872820864248,510.512684847429,511.152548830610,511.792412813791,512.432276796972,513.072140780153,513.712004763334,514.351868746515,
    514.991732729695,515.631596712876,516.271460696057,516.911324679238,517.551188662419,518.191052645600,518.830916628781,519.470780611962,520.110644595142,520.750508578323,
    521.390372561504,522.030236544685,522.670100527866,523.309964511047,523.949828494228,524.589692477409,525.229556460589,525.869420443770,526.509284426951,527.149148410132,
    527.789012393313,528.428876376494,529.068740359675,529.708604342856,530.348468326036,530.988332309217,531.628196292398,532.268060275579,532.907924258760,533.547788241941,
    534.187652225122,534.827516208303,535.467380191483,536.107244174664,536.747108157845,537.386972141026,538.026836124207,538.666700107388,539.306564090569,539.946428073750,
    540.586292056930,541.226156040111,541.866020023292,542.505884006473,543.145747989654,543.785611972835,544.425475956016,545.065339939197,545.705203922377,546.345067905558,
    546.984931888739,547.624795871920,548.264659855101,548.904523838282,549.544387821463,550.184251804644,550.824115787824,551.463979771005,552.103843754186,552.743707737367,
    553.383571720548,554.023435703729,554.663299686910,555.303163670091,555.943027653271,556.582891636452,557.222755619633,557.862619602814,558.502483585995,559.142347569176,
    559.782211552357,560.422075535538,561.061939518718,561.701803501899,562.341667485080,562.981531468261,563.621395451442,564.261259434623,564.901123417804,565.540987400985,
    566.180851384165,566.820715367346,567.460579350527,568.100443333708,568.740307316889,569.380171300070,570.020035283251,570.659899266432,571.299763249613,571.939627232793,
    572.579491215974,573.219355199155,573.859219182336,574.499083165517,575.138947148698,575.778811131879,576.418675115060,577.058539098240,577.698403081421,578.338267064602,
    578.978131047783,579.617995030964,580.257859014145,580.897722997326,581.537586980506,582.177450963687,582.817314946868,583.457178930049,584.097042913230,584.736906896411,
    585.376770879592,586.016634862773,586.656498845953,587.296362829134,587.936226812315,588.576090795496,589.215954778677,589.855818761858,590.495682745039,591.135546728220,
    591.775410711400,592.415274694581,593.055138677762,593.695002660943,594.334866644124,594.974730627305,595.614594610486,596.254458593667,596.894322576847,597.534186560028,
    598.174050543209,598.813914526390,599.453778509571,600.093642492752,600.733506475933,601.373370459114,602.013234442294,602.653098425475,603.292962408656,603.932826391837,
    604.572690375018,605.212554358199,605.852418341380,606.492282324561,607.132146307741,607.772010290922,608.411874274103,609.051738257284,609.691602240465,610.331466223646,
    610.971330206827,611.611194190008,612.251058173188,612.890922156369,613.530786139550,614.170650122731,614.810514105912,615.450378089093,616.090242072274,616.730106055455,
    617.369970038636,618.009834021816,618.649698004997,619.289561988178,619.929425971359,620.569289954540,621.209153937721,621.849017920902,622.488881904083,623.128745887263,
    623.768609870444,624.408473853625,625.048337836806,625.688201819987,626.328065803168,626.967929786349,627.607793769530,628.247657752710,628.887521735891,629.527385719072,
    630.167249702253,630.807113685434,631.446977668615,632.086841651796,632.726705634976,633.366569618157,634.006433601338,634.646297584519,635.286161567700,635.926025550881,
    636.565889534062,637.205753517243,637.845617500423,638.485481483604,639.125345466785,639.765209449966,640.405073433147,641.044937416328,641.684801399509,642.324665382690,
    642.964529365870,643.604393349051,644.244257332232,644.884121315413,645.523985298594,646.163849281775,646.803713264956,647.443577248137,648.083441231317,648.723305214498,
    649.363169197679,650.003033180860,650.642897164041,651.282761147222,651.922625130403,652.562489113584,653.202353096764,653.842217079945,654.482081063126,655.121945046307,
    655.761809029488,656.401673012669,657.041536995850,657.681400979031,658.321264962211,658.961128945392,659.600992928573,660.240856911754,660.880720894935,661.520584878116,
    662.160448861297,662.800312844478,663.440176827658,664.080040810839,664.719904794020,665.359768777201,665.999632760382,666.639496743563,667.279360726744,667.919224709925,
    668.559088693106,669.198952676286,669.838816659467,670.478680642648,671.118544625829,671.758408609010,672.398272592191,673.038136575372,673.678000558553,674.317864541733,
    674.957728524914,675.597592508095,676.237456491276,676.877320474457,677.517184457638,678.157048440819,678.796912424000,679.436776407180,680.076640390361,680.716504373542,
    681.356368356723,681.996232339904,682.636096323085,683.275960306266,683.915824289447,684.555688272627,685.195552255808,685.835416238989,686.475280222170,687.115144205351,
    687.755008188532,688.394872171713,689.034736154893,689.674600138074,690.314464121255,690.954328104436,691.594192087617,692.234056070798,692.873920053979,693.513784037160,
    694.153648020340,694.793512003521,695.433375986702,696.073239969883,696.713103953064,697.352967936245,697.992831919426,698.632695902607,699.272559885787,699.912423868968,
    700.552287852149,701.192151835330,701.832015818511,702.471879801692,703.111743784873,703.751607768054,704.391471751234,705.031335734415,705.671199717596,706.311063700777,
    706.950927683958,707.590791667139,708.230655650320,708.870519633501,709.510383616682,710.150247599862,710.790111583043,711.429975566224,712.069839549405,712.709703532586,
    713.349567515767,713.989431498948,714.629295482129,715.269159465309,715.909023448490,716.548887431671,717.188751414852,717.828615398033,718.468479381214,719.108343364395,
    719.748207347576,720.388071330756,721.027935313937,721.667799297118,722.307663280299,722.947527263480,723.587391246661,724.227255229842,724.867119213023,725.506983196203,
    726.146847179384,726.786711162565,727.426575145746,728.066439128927,728.706303112108,729.346167095289,729.986031078470,730.625895061650,731.265759044831,731.905623028012,
    732.545487011193,733.185350994374,733.825214977555,734.465078960736,735.104942943917,735.744806927097,736.384670910278,737.024534893459,737.664398876640,738.304262859821,
    738.944126843002,739.583990826183,740.223854809364,740.863718792544,741.503582775725,742.143446758906,742.783310742087,743.423174725268,744.063038708449,744.702902691630,
    745.342766674810,745.982630657991,746.622494641172,747.262358624353,747.902222607534,748.542086590715,749.181950573896,749.821814557077,750.461678540257,751.101542523438,
    751.741406506619,752.381270489800,753.021134472981,753.660998456162,754.300862439343,754.940726422524,755.580590405704,756.220454388885,756.860318372066,757.500182355247,
    758.140046338428,758.779910321609,759.419774304790,760.059638287971,760.699502271151,761.339366254332,761.979230237513,762.619094220694,763.258958203875,763.898822187056,
    764.538686170237,765.178550153418,765.818414136599,766.458278119779,767.098142102960,767.738006086141,768.377870069322,769.017734052503,769.657598035684,770.297462018865,
    770.937326002046,771.577189985226,772.217053968407,772.856917951588,773.496781934769,774.136645917950,774.776509901131,775.416373884312,776.056237867493,776.696101850673,
    777.335965833854,777.975829817035,778.615693800216,779.255557783397,779.895421766578,780.535285749759,781.175149732940,781.815013716120,782.454877699301,783.094741682482,
    783.734605665663,784.374469648844,785.014333632025,785.654197615206,786.294061598387,786.933925581567,787.573789564748,788.213653547929,788.853517531110,789.493381514291,
    790.133245497472,790.773109480653,791.412973463834,792.052837447014,792.692701430195,793.332565413376,793.972429396557,794.612293379738,795.252157362919,795.892021346100,
    796.531885329280,797.171749312461,797.811613295642,798.451477278823,799.091341262004,799.731205245185,800.371069228366,801.010933211547,801.650797194728,802.290661177908,
    802.930525161089,803.570389144270,804.210253127451,804.850117110632,805.489981093813,806.129845076994,806.769709060175,807.409573043355,808.049437026536,808.689301009717,
    809.329164992898,809.969028976079,810.608892959260,811.248756942441,811.888620925622,812.528484908802,813.168348891983,813.808212875164,814.448076858345,815.087940841526,
    815.727804824707,816.367668807888,817.007532791069,817.647396774250,818.287260757430,818.927124740611,819.566988723792,820.206852706973,820.846716690154,821.486580673335,
    822.126444656516,822.766308639696,823.406172622877,824.046036606058,824.685900589239,825.325764572420,825.965628555601,826.605492538782,827.245356521963,827.885220505143,
    828.525084488324,829.164948471505,829.804812454686,830.444676437867,831.084540421048,831.724404404229,832.364268387410,833.004132370590,833.643996353771,834.283860336952,
    834.923724320133,835.563588303314,836.203452286495,836.843316269676,837.483180252857,838.123044236037,838.762908219218,839.402772202399,840.042636185580,840.682500168761,
    841.322364151942,841.962228135123,842.602092118304,843.241956101484,843.881820084665,844.521684067846,845.161548051027,845.801412034208,846.441276017389,847.081140000570,
    847.721003983751,848.360867966931,849.000731950112,849.640595933293,850.280459916474,850.920323899655,851.560187882836,852.200051866017,852.839915849197,853.479779832378,
    854.119643815559,854.759507798740,855.399371781921,856.039235765102,856.679099748283,857.318963731464,857.958827714644,858.598691697825,859.238555681006,859.878419664187,
    860.518283647368,861.158147630549,861.798011613730,862.437875596911,863.077739580092,863.717603563272,864.357467546453,864.997331529634,865.637195512815,866.277059495996,
    866.916923479177,867.556787462358,868.196651445539,868.836515428719,869.476379411900,870.116243395081,870.756107378262,871.395971361443,872.035835344624,872.675699327805,
    873.315563310986,873.955427294166,874.595291277347,875.235155260528,875.875019243709,876.514883226890,877.154747210071,877.794611193252,878.434475176433,879.074339159613,
    879.714203142794,880.354067125975,880.993931109156,881.633795092337,882.273659075518,882.913523058699,883.553387041880,884.193251025060,884.833115008241,885.472978991422,
    886.112842974603,886.752706957784,887.392570940965,888.032434924146,888.672298907327,889.312162890507,889.952026873688,890.591890856869,891.231754840050,891.871618823231,
    892.511482806412,893.151346789593,893.791210772774,894.431074755954,895.070938739135,895.710802722316,896.350666705497,896.990530688678,897.630394671859,898.270258655040,
    898.910122638221,899.549986621401,900.189850604582,900.829714587763,901.469578570944,902.109442554125,902.749306537306,903.389170520487,904.029034503668,904.668898486848,
    905.308762470029,905.948626453210,906.588490436391,907.228354419572,907.868218402753,908.508082385934,909.147946369115,909.787810352296,910.427674335476,911.067538318657,
    911.707402301838,912.347266285019,912.987130268200,913.626994251381,914.266858234562,914.906722217743,915.546586200923,916.186450184104,916.826314167285,917.466178150466,
    918.106042133647,918.745906116828,919.385770100009,920.025634083190,920.665498066370,921.305362049551,921.945226032732,922.585090015913,923.224953999094,923.864817982275,
    924.504681965456,925.144545948637,925.784409931817,926.424273914998,927.064137898179,927.704001881360,928.343865864541,928.983729847722,929.623593830903,930.263457814083,
    930.903321797264,931.543185780445,932.183049763626,932.822913746807,933.462777729988,934.102641713169,934.742505696350,935.382369679530,936.022233662711,936.662097645892,
    937.301961629073,937.941825612254,938.581689595435,939.221553578616,939.861417561797,940.501281544977,941.141145528158,941.781009511339,942.420873494520,943.060737477701,
    943.700601460882,944.340465444063,944.980329427244,945.620193410424,946.260057393605,946.899921376786,947.539785359967,948.179649343148,948.819513326329,949.459377309510,
    950.099241292691,950.739105275871,951.378969259052,952.018833242233,952.658697225414,953.298561208595,953.938425191776,954.578289174957,955.218153158138,955.858017141318,
    956.497881124499,957.137745107680,957.777609090861,958.417473074042,959.057337057223,959.697201040404,960.337065023585,960.976929006765,961.616792989946,962.256656973127,
    962.896520956308,963.536384939489,964.176248922670,964.816112905851,965.455976889032,966.095840872212,966.735704855393,967.375568838574,968.015432821755,968.655296804936,
    969.295160788117,969.935024771298,970.574888754479,971.214752737659,971.854616720840,972.494480704021,973.134344687202,973.774208670383,974.414072653564,975.053936636745,
    975.693800619926,976.333664603106,976.973528586287,977.613392569468,978.253256552649,978.893120535830,979.532984519011,980.172848502192,980.812712485373,981.452576468554,
    982.092440451734,982.732304434915,983.372168418096,984.012032401277,984.651896384458,985.291760367639,985.931624350820,986.571488334000,987.211352317181,987.851216300362,
    988.491080283543,989.130944266724,989.770808249905,990.410672233086,991.050536216267,991.690400199447,992.330264182628,992.970128165809,993.609992148990,994.249856132171,
    994.889720115352,995.529584098533,996.169448081714,996.809312064894,997.449176048075,998.089040031256,998.728904014437,999.368767997618,1000.00863198080,1000.64849596398,
    1001.28835994716,1001.92822393034,1002.56808791352,1003.20795189670,1003.84781587988,1004.48767986307,1005.12754384625,1005.76740782943,1006.40727181261,1007.04713579579,
    1007.68699977897,1008.32686376215,1008.96672774533,1009.60659172851,1010.24645571169,1010.88631969487,1011.52618367805,1012.16604766124,1012.80591164442,1013.44577562760,
    1014.08563961078,1014.72550359396,1015.36536757714,1016.00523156032,1016.64509554350,1017.28495952668,1017.92482350986,1018.56468749304,1019.20455147623,1019.84441545941,
    1020.48427944259,1021.12414342577,1021.76400740895,1022.40387139213,1023.04373537531,1023.68359935849,1024.32346334167,1024.96332732485,1025.60319130803,1026.24305529121,
    1026.88291927440,1027.52278325758,1028.16264724076,1028.80251122394,1029.44237520712,1030.08223919030,1030.72210317348,1031.36196715666,1032.00183113984,1032.64169512302,
    1033.28155910620,1033.92142308939,1034.56128707257,1035.20115105575,1035.84101503893,1036.48087902211,1037.12074300529,1037.76060698847,1038.40047097165,1039.04033495483,
    1039.68019893801,1040.32006292119,1040.95992690437,1041.59979088756,1042.23965487074,1042.87951885392,1043.5193828371,1044.15924682028,1044.79911080346,1045.43897478664,
    1046.07883876982,1046.71870275300,1047.35856673618,1047.99843071936,1048.63829470255,1049.27815868573,1049.91802266891,1050.55788665209,1051.19775063527,1051.83761461845,
    1052.47747860163,1053.11734258481,1053.75720656799,1054.39707055117,1055.03693453435,1055.67679851753,1056.31666250072,1056.95652648390,1057.59639046708,1058.23625445026,
    1058.87611843344,1059.51598241662,1060.15584639980,1060.79571038298,1061.43557436616,1062.07543834934,1062.71530233252,1063.35516631571,1063.99503029889,1064.63489428207,
    1065.27475826525,1065.91462224843,1066.55448623161,1067.19435021479,1067.83421419797,1068.47407818115,1069.11394216433,1069.75380614751,1070.39367013070,1071.03353411388,
    1071.67339809706,1072.31326208024,1072.95312606342,1073.59299004660,1074.23285402978,1074.87271801296,1075.51258199614,1076.15244597932,1076.79230996250,1077.43217394568,
    1078.07203792887,1078.71190191205,1079.35176589523,1079.99162987841,1080.63149386159,1081.27135784477,1081.91122182795,1082.55108581113,1083.19094979431,1083.83081377749,
    1084.47067776067,1085.11054174386,1085.75040572704,1086.39026971022,1087.03013369340,1087.66999767658,1088.30986165976,1088.94972564294,1089.58958962612,1090.22945360930,
    1090.86931759248,1091.50918157566,1092.14904555885,1092.78890954203,1093.42877352521,1094.06863750839,1094.70850149157,1095.34836547475,1095.98822945793,1096.62809344111,
    1097.26795742429,1097.90782140747,1098.54768539065,1099.18754937383,1099.82741335702,1100.46727734020,1101.10714132338,1101.74700530656,1102.38686928974,1103.02673327292,
    1103.66659725610,1104.30646123928,1104.94632522246,1105.58618920564,1106.22605318882,1106.86591717201,1107.50578115519,1108.14564513837,1108.78550912155,1109.42537310473,
    1110.06523708791,1110.70510107109,1111.34496505427,1111.98482903745,1112.62469302063,1113.26455700381,1113.90442098699,1114.54428497018,1115.18414895336,1115.82401293654,
    1116.46387691972,1117.10374090290,1117.74360488608,1118.38346886926,1119.02333285244,1119.66319683562,1120.30306081880,1120.94292480198,1121.58278878517,1122.22265276835,
    1122.86251675153,1123.50238073471,1124.14224471789,1124.78210870107,1125.42197268425,1126.06183666743,1126.70170065061,1127.34156463379,1127.98142861697,1128.62129260015,
    1129.26115658334,1129.90102056652,1130.54088454970,1131.18074853288,1131.82061251606,1132.46047649924,1133.10034048242,1133.74020446560,1134.38006844878,1135.01993243196,
    1135.65979641514,1136.29966039833,1136.93952438151,1137.57938836469,1138.21925234787,1138.85911633105,1139.49898031423,1140.13884429741,1140.77870828059,1141.41857226377,
    1142.05843624695,1142.69830023013,1143.33816421331,1143.97802819650,1144.61789217968,1145.25775616286,1145.89762014604,1146.53748412922,1147.17734811240,1147.81721209558,
    1148.45707607876,1149.09694006194,1149.73680404512,1150.37666802830,1151.01653201149,1151.65639599467,1152.29625997785,1152.93612396103,1153.57598794421,1154.21585192739,
    1154.85571591057,1155.49557989375,1156.13544387693,1156.77530786011,1157.41517184329,1158.05503582647,1158.69489980966,1159.33476379284,1159.97462777602,1160.61449175920,
    1161.25435574238,1161.89421972556,1162.53408370874,1163.17394769192,1163.81381167510,1164.45367565828,1165.09353964146,1165.73340362465,1166.37326760783,1167.01313159101,
    1167.65299557419,1168.29285955737,1168.93272354055,1169.57258752373,1170.21245150691,1170.85231549009,1171.49217947327,1172.13204345645,1172.77190743964,1173.41177142282,
    1174.05163540600,1174.69149938918,1175.33136337236,1175.97122735554,1176.61109133872,1177.25095532190,1177.89081930508,1178.53068328826,1179.17054727144,1179.81041125462,
    1180.45027523781,1181.09013922099,1181.73000320417,1182.36986718735,1183.00973117053,1183.64959515371,1184.28945913689,1184.92932312007,1185.56918710325,1186.20905108643,
    1186.84891506961,1187.48877905280,1188.12864303598,1188.76850701916,1189.40837100234,1190.04823498552,1190.68809896870,1191.32796295188,1191.96782693506,1192.60769091824,
    1193.24755490142,1193.88741888460,1194.52728286778,1195.16714685097,1195.80701083415,1196.44687481733,1197.08673880051,1197.72660278369,1198.36646676687,1199.00633075005,
    1199.64619473323,1200.28605871641,1200.92592269959,1201.56578668277,1202.20565066596,1202.84551464914,1203.48537863232,1204.12524261550,1204.76510659868,1205.40497058186,
    1206.04483456504,1206.68469854822,1207.32456253140,1207.96442651458,1208.60429049776,1209.24415448095,1209.88401846413,1210.52388244731,1211.16374643049,1211.80361041367,
    1212.44347439685,1213.08333838003,1213.72320236321,1214.36306634639,1215.00293032957,1215.64279431275,1216.28265829593,1216.92252227912,1217.56238626230,1218.20225024548,
    1218.84211422866,1219.48197821184,1220.12184219502,1220.76170617820,1221.40157016138,1222.04143414456,1222.68129812774,1223.32116211092,1223.96102609411,1224.60089007729,
    1225.24075406047,1225.88061804365,1226.52048202683,1227.16034601001,1227.80020999319,1228.44007397637,1229.07993795955,1229.71980194273,1230.35966592591,1230.99952990909,
    1231.63939389228,1232.27925787546,1232.91912185864,1233.55898584182,1234.19884982500,1234.83871380818,1235.47857779136,1236.11844177454,1236.75830575772,1237.39816974090,
    1238.03803372408,1238.67789770727,1239.31776169045,1239.95762567363,1240.59748965681,1241.23735363999,1241.87721762317,1242.51708160635,1243.15694558953,1243.79680957271,
    1244.43667355589,1245.07653753907,1245.71640152225,1246.35626550544,1246.99612948862,1247.63599347180,1248.27585745498,1248.91572143816,1249.55558542134,1250.19544940452,
    1250.83531338770,1251.47517737088,1252.11504135406,1252.75490533724,1253.39476932043,1254.03463330361,1254.67449728679,1255.31436126997,1255.95422525315,1256.59408923633,
    1257.23395321951,1257.87381720269,1258.51368118587,1259.15354516905,1259.79340915223,1260.43327313542,1261.07313711860,1261.71300110178,1262.35286508496,1262.99272906814,
    1263.63259305132,1264.27245703450,1264.91232101768,1265.55218500086,1266.19204898404,1266.83191296722,1267.47177695040,1268.11164093359,1268.75150491677,1269.39136889995,
    1270.03123288313,1270.67109686631,1271.31096084949,1271.95082483267,1272.59068881585,1273.23055279903,1273.87041678221,1274.51028076539,1275.15014474858,1275.79000873176,
    1276.42987271494,1277.06973669812,1277.70960068130,1278.34946466448,1278.98932864766,1279.62919263084,1280.26905661402,1280.90892059720,1281.54878458038,1282.18864856356,
    1282.82851254675,1283.46837652993,1284.10824051311,1284.74810449629,1285.38796847947,1286.02783246265,1286.66769644583,1287.30756042901,1287.94742441219,1288.58728839537,
    1289.22715237855,1289.86701636174,1290.50688034492,1291.14674432810,1291.78660831128,1292.42647229446,1293.06633627764,1293.70620026082,1294.34606424400,1294.98592822718,
    1295.62579221036,1296.26565619354,1296.90552017673,1297.54538415991,1298.18524814309,1298.82511212627,1299.46497610945,1300.10484009263,1300.74470407581,1301.38456805899,
    1302.02443204217,1302.66429602535,1303.30416000853,1303.94402399171,1304.58388797490,1305.22375195808,1305.86361594126,1306.50347992444,1307.14334390762,1307.78320789080,
    1308.42307187398,1309.06293585716,1309.70279984034,1310.34266382352,1310.98252780670,1311.62239178989,1312.26225577307,1312.90211975625,1313.54198373943,1314.18184772261,
    1314.82171170579,1315.46157568897,1316.10143967215,1316.74130365533,1317.38116763851,1318.02103162169,1318.66089560487,1319.30075958806,1319.94062357124,1320.58048755442,
    1321.22035153760,1321.86021552078,1322.50007950396,1323.13994348714,1323.77980747032,1324.41967145350,1325.05953543668,1325.69939941986,1326.33926340305,1326.97912738623,
    1327.61899136941,1328.25885535259,1328.89871933577,1329.53858331895,1330.17844730213,1330.81831128531,1331.45817526849,1332.09803925167,1332.73790323485,1333.37776721803,
    1334.01763120122,1334.65749518440,1335.29735916758,1335.93722315076,1336.57708713394,1337.21695111712,1337.85681510030,1338.49667908348,1339.13654306666,1339.77640704984,
    1340.41627103302,1341.05613501621,1341.69599899939,1342.33586298257,1342.97572696575,1343.61559094893,1344.25545493211,1344.89531891529,1345.53518289847,1346.17504688165,
    1346.81491086483,1347.45477484801,1348.09463883119,1348.73450281438,1349.37436679756,1350.01423078074,1350.65409476392,1351.29395874710,1351.93382273028,1352.57368671346,
    1353.21355069664,1353.85341467982,1354.49327866300,1355.13314264618,1355.77300662937,1356.41287061255,1357.05273459573,1357.69259857891,1358.33246256209,1358.97232654527,
    1359.61219052845,1360.25205451163,1360.89191849481,1361.53178247799,1362.17164646117,1362.81151044436,1363.45137442754,1364.09123841072,1364.73110239390,1365.37096637708,
    1366.01083036026,1366.65069434344,1367.29055832662,1367.93042230980,1368.57028629298,1369.21015027616,1369.85001425934,1370.48987824253,1371.12974222571,1371.76960620889,
    1372.40947019207,1373.04933417525,1373.68919815843,1374.32906214161,1374.96892612479,1375.60879010797,1376.24865409115,1376.88851807433,1377.52838205752,1378.16824604070,
    1378.80811002388,1379.44797400706,1380.08783799024,1380.72770197342,1381.36756595660,1382.00742993978,1382.64729392296,1383.28715790614,1383.92702188932,1384.56688587250}; // [nm] 10 wavelengths per line, 2160 total
} // !flg_vnir

if(flg_swir){
  wvl_pxl@long_name="Wavelength corresponding to each pixel in SWIR calibration";
  wvl_pxl[wvl_pxl]={ // [nm] 10 wavelengths per line, 288 total
    856.416960259833,862.331294648684,868.245629037536,874.159963426387,880.074297815239,885.988632204090,891.902966592942,897.817300981793,903.731635370644,909.645969759496,
    915.560304148347,921.474638537199,927.388972926050,933.303307314902,939.217641703753,945.131976092604,951.046310481456,956.960644870307,962.874979259159,968.789313648010,
    974.703648036862,980.617982425713,986.532316814564,992.446651203416,998.360985592267,1004.27531998112,1010.18965436997,1016.10398875882,1022.01832314767,1027.93265753652,
    1033.84699192538,1039.76132631423,1045.67566070308,1051.58999509193,1057.50432948078,1063.41866386963,1069.33299825848,1075.24733264734,1081.16166703619,1087.07600142504,
    1092.99033581389,1098.90467020274,1104.81900459159,1110.73333898044,1116.64767336930,1122.56200775815,1128.47634214700,1134.39067653585,1140.30501092470,1146.21934531355,
    1152.13367970240,1158.04801409126,1163.96234848011,1169.87668286896,1175.79101725781,1181.70535164666,1187.61968603551,1193.53402042436,1199.44835481322,1205.36268920207,
    1211.27702359092,1217.19135797977,1223.10569236862,1229.02002675747,1234.93436114632,1240.84869553518,1246.76302992403,1252.67736431288,1258.59169870173,1264.50603309058,
    1270.42036747943,1276.33470186828,1282.24903625714,1288.16337064599,1294.07770503484,1299.99203942369,1305.90637381254,1311.82070820139,1317.73504259025,1323.64937697910,
    1329.56371136795,1335.47804575680,1341.39238014565,1347.30671453450,1353.22104892335,1359.13538331221,1365.04971770106,1370.96405208991,1376.87838647876,1382.79272086761,
    1388.70705525646,1394.62138964531,1400.53572403417,1406.45005842302,1412.36439281187,1418.27872720072,1424.19306158957,1430.10739597842,1436.02173036727,1441.93606475613,
    1447.85039914498,1453.76473353383,1459.67906792268,1465.59340231153,1471.50773670038,1477.42207108923,1483.33640547809,1489.25073986694,1495.16507425579,1501.07940864464,
    1506.99374303349,1512.90807742234,1518.82241181119,1524.73674620005,1530.65108058890,1536.56541497775,1542.47974936660,1548.39408375545,1554.30841814430,1560.22275253315,
    1566.13708692201,1572.05142131086,1577.96575569971,1583.88009008856,1589.79442447741,1595.70875886626,1601.62309325511,1607.53742764397,1613.45176203282,1619.36609642167,
    1625.28043081052,1631.19476519937,1637.10909958822,1643.02343397707,1648.93776836593,1654.85210275478,1660.76643714363,1666.68077153248,1672.59510592133,1678.50944031018,
    1684.42377469903,1690.33810908789,1696.25244347674,1702.16677786559,1708.08111225444,1713.99544664329,1719.90978103214,1725.82411542099,1731.73844980985,1737.65278419870,
    1743.56711858755,1749.48145297640,1755.39578736525,1761.31012175410,1767.22445614295,1773.13879053181,1779.05312492066,1784.96745930951,1790.88179369836,1796.79612808721,
    1802.71046247606,1808.62479686491,1814.53913125377,1820.45346564262,1826.36780003147,1832.28213442032,1838.19646880917,1844.11080319802,1850.02513758687,1855.93947197573,
    1861.85380636458,1867.76814075343,1873.68247514228,1879.59680953113,1885.51114391998,1891.42547830883,1897.33981269769,1903.25414708654,1909.16848147539,1915.08281586424,
    1920.99715025309,1926.91148464194,1932.82581903079,1938.74015341965,1944.65448780850,1950.56882219735,1956.48315658620,1962.39749097505,1968.31182536390,1974.22615975275,
    1980.14049414161,1986.05482853046,1991.96916291931,1997.88349730816,2003.79783169701,2009.71216608586,2015.62650047471,2021.54083486357,2027.45516925242,2033.36950364127,
    2039.28383803012,2045.19817241897,2051.11250680782,2057.02684119667,2062.94117558553,2068.85550997438,2074.76984436323,2080.68417875208,2086.59851314093,2092.51284752978,
    2098.42718191863,2104.34151630749,2110.25585069634,2116.17018508519,2122.08451947404,2127.99885386289,2133.91318825174,2139.82752264059,2145.74185702945,2151.65619141830,
    2157.57052580715,2163.48486019600,2169.39919458485,2175.31352897370,2181.22786336255,2187.14219775141,2193.05653214026,2198.97086652911,2204.88520091796,2210.79953530681,
    2216.71386969566,2222.62820408451,2228.54253847337,2234.45687286222,2240.37120725107,2246.28554163992,2252.19987602877,2258.11421041762,2264.02854480648,2269.94287919533,
    2275.85721358418,2281.77154797303,2287.68588236188,2293.60021675073,2299.51455113958,2305.42888552843,2311.34321991729,2317.25755430614,2323.17188869499,2329.08622308384,
    2335.00055747269,2340.91489186154,2346.82922625040,2352.74356063925,2358.65789502810,2364.57222941695,2370.48656380580,2376.40089819465,2382.31523258350,2388.22956697236,
    2394.14390136121,2400.05823575006,2405.97257013891,2411.88690452776,2417.80123891661,2423.71557330546,2429.62990769432,2435.54424208317,2441.45857647202,2447.37291086087,
    2453.28724524972,2459.20157963857,2465.11591402742,2471.03024841628,2476.94458280513,2482.85891719398,2488.77325158283,2494.68758597168,2500.60192036053,2506.51625474938,
    2512.43058913824,2518.34492352709,2524.25925791594,2530.17359230479,2536.08792669364,2542.00226108249,2547.91659547134,2553.83092986020}; // [nm] 10 wavelengths per line, 288 total
} // !flg_swir

// Change pixel wavelengths from nm to m (SI)
wvl_pxl*=1.0e-9; // [m]

// [nbr] Number of wavelengths in factory calibration of Spectralon reference
*wvl_clb_nbr=2201;
defdim("wvl_clb",wvl_clb_nbr);
wvl_clb[wvl_clb]=0.0f; // [m]
wvl_clb@long_name="Wavelength of factory calibration of Spectralon reference";
wvl_clb@standard_name="sensor_band_central_radiation_wavelength";
wvl_clb@units="meter";
wvl_clb@provenance="Factory calibration";
wvl_clb=array(250.0,1.0,$wvl_clb);
// Change calibration wavelengths from nm to m (SI)
wvl_clb*=1.0e-9; // [m]

/* 20161005: 
   About 20160927 Tino Dornbusch posted PDF of SphereOptics calibration certificate, which reads
   "Sample: Zenith Polymer Diffuse Reflectance Standard - 99%R
   Report-No: 16042606
   PO-NO.: 600982
   Customer: LemnaTec GmbH
   The 8 degree/hemispherical spectral reflectance was measured for the sample listed above. The calibration was performed with a standard from SphereOptics GmbH, part number SG3051, traceable to the PTB (Physikalisch Technische Bundesanstalt), calibration certificate: PTB 44052/15. The reflectance was determined by using a Perkin-Elmer Lambda 950 UV-VIS-NIR spectrometer (serial number 950L1211082) equipped with a 150 mm PTFE sphere (certified by PTB Braunschweig, Germany)."

   A few days later, maybe 20161001, David LeBauer (or TinoDornbusch) posted a reflectance file here: https://github.com/terraref/reference-data/blob/master/Zenith%20LiteT%20Diffuse%20Reflectance%20Target%20-%2095%25R.csv
   Presumably these reflectances are for the SphereOptics part in the certification.
   The file header reads "Factory calibration of Zenith Lite Diffuse Reflectance Target - 95%R.csv;Reflectivity: 95% (UV-VIS-NIR);DETECTOR-PC\admin;10.04.2014 15:35:46;Lambda 950;950L1211082;1.61.00 Lambda 900".
   Data are 2201 absolute calibrated reflectances at 1 nm resolution from 250--2450 nm.
   More information at https://github.com/terraref/reference-data/issues/53 */
*factory_calibrated_reflectance[wvl_clb]={ // [frc] 10 wavelengths per line, 2201 total
0.911211,0.912225,0.912077,0.912555,0.911949,0.912477,0.912572,0.913257,0.913936,0.914543,
0.914366,0.913324,0.912303,0.912679,0.912197,0.913096,0.914527,0.913261,0.913015,0.911970,
0.911637,0.913419,0.914956,0.917668,0.920981,0.921512,0.920908,0.919402,0.922392,0.926741,
0.931516,0.937165,0.941877,0.946076,0.949313,0.951880,0.952553,0.954833,0.955475,0.956108,
0.957789,0.957477,0.960004,0.960285,0.960403,0.960697,0.961353,0.963175,0.964319,0.964685,
0.964547,0.965108,0.966084,0.965455,0.966456,0.967565,0.967576,0.967680,0.968352,0.968707,
0.967874,0.967192,0.967611,0.968063,0.967609,0.967869,0.966688,0.966557,0.967813,0.967492,
0.966181,0.967395,0.966399,0.967181,0.966879,0.965786,0.964756,0.964795,0.964039,0.964803,
0.964897,0.963840,0.963335,0.964312,0.964653,0.965653,0.965872,0.964736,0.964772,0.964391,
0.963847,0.964159,0.965069,0.964616,0.963029,0.962872,0.963695,0.964966,0.965544,0.964408,
0.963434,0.964032,0.964256,0.963713,0.963915,0.964502,0.965175,0.965585,0.965256,0.965827,
0.965300,0.965061,0.965566,0.965335,0.964925,0.965006,0.964323,0.963462,0.963755,0.964239,
0.964311,0.963618,0.963138,0.963597,0.965257,0.965480,0.963993,0.964632,0.965310,0.964386,
0.964208,0.965117,0.965043,0.964768,0.965206,0.965615,0.965207,0.964762,0.964986,0.965097,
0.965081,0.965073,0.964839,0.964607,0.965243,0.965378,0.964945,0.964719,0.964431,0.963935,
0.964036,0.964284,0.964586,0.963829,0.964616,0.965230,0.965202,0.964587,0.964293,0.964366,
0.964595,0.964727,0.965303,0.965955,0.965649,0.964889,0.965686,0.966398,0.965494,0.965360,
0.966049,0.965984,0.966807,0.966860,0.966472,0.966200,0.965970,0.966903,0.967187,0.966432,
0.966477,0.967024,0.967078,0.966130,0.966655,0.966290,0.966200,0.966160,0.965830,0.965543,
0.965865,0.966037,0.966651,0.966431,0.965840,0.966027,0.966113,0.966043,0.966053,0.965786,
0.967416,0.966602,0.967129,0.966475,0.967036,0.967181,0.966948,0.966192,0.966513,0.966960,
0.966929,0.967086,0.967727,0.967169,0.966299,0.966640,0.966351,0.967478,0.967107,0.967298,
0.967520,0.966688,0.966949,0.966935,0.967096,0.967540,0.967540,0.967433,0.967459,0.967669,
0.967648,0.966885,0.967101,0.967666,0.967166,0.966983,0.967706,0.967600,0.968113,0.967301,
0.966775,0.967317,0.968409,0.967923,0.967505,0.967803,0.967218,0.967877,0.967573,0.968005,
0.967668,0.967707,0.967252,0.967582,0.967768,0.967735,0.967667,0.967587,0.968103,0.967927,
0.968366,0.967960,0.967955,0.968092,0.967692,0.967943,0.968220,0.967912,0.967891,0.967651,
0.967564,0.968472,0.967875,0.968227,0.968008,0.968272,0.968047,0.968228,0.967684,0.968073,
0.967908,0.967487,0.967444,0.967982,0.968230,0.968012,0.967946,0.967843,0.967562,0.967548,
0.967578,0.967966,0.967490,0.967362,0.967853,0.967906,0.967781,0.968299,0.968460,0.967827,
0.968216,0.968387,0.967701,0.967787,0.968319,0.968409,0.968418,0.967742,0.967903,0.968483,
0.968073,0.967529,0.967373,0.967883,0.968508,0.967511,0.967134,0.967479,0.967547,0.967729,
0.967879,0.967901,0.968022,0.967945,0.967840,0.968081,0.968094,0.968148,0.967756,0.967419,
0.968057,0.968578,0.968381,0.967804,0.967515,0.967977,0.968323,0.968181,0.967776,0.968330,
0.968093,0.967944,0.968099,0.968039,0.968512,0.968294,0.968253,0.968174,0.967737,0.967978,
0.968204,0.968043,0.967456,0.967328,0.967972,0.968147,0.967706,0.967998,0.967250,0.966984,
0.967125,0.967604,0.967404,0.967104,0.967211,0.967175,0.967455,0.967378,0.967354,0.967950,
0.967912,0.967392,0.966959,0.966812,0.967363,0.967522,0.967833,0.967037,0.967193,0.967806,
0.967630,0.967275,0.967269,0.967387,0.967834,0.967687,0.967719,0.967599,0.968502,0.967785,
0.967668,0.968078,0.967413,0.967188,0.967710,0.966873,0.967694,0.967872,0.967416,0.968219,
0.967355,0.967265,0.967154,0.967723,0.967330,0.968062,0.967616,0.968117,0.966661,0.967057,
0.967088,0.967857,0.967285,0.966877,0.967573,0.967645,0.967649,0.966476,0.966993,0.966674,
0.966704,0.967626,0.967031,0.967061,0.966131,0.967179,0.966640,0.965991,0.966848,0.966608,
0.966540,0.966432,0.966673,0.966029,0.966127,0.966741,0.966110,0.966465,0.966132,0.966957,
0.965746,0.966815,0.966696,0.966088,0.966968,0.965510,0.965952,0.966456,0.965825,0.966059,
0.966061,0.965841,0.965774,0.966846,0.965341,0.967192,0.965388,0.965629,0.966815,0.965806,
0.965880,0.967206,0.966164,0.966873,0.966267,0.965250,0.966232,0.965749,0.965213,0.965424,
0.966661,0.965753,0.966519,0.965528,0.964842,0.965796,0.965099,0.964832,0.964366,0.966841,
0.966321,0.965766,0.965842,0.964817,0.965267,0.965675,0.964223,0.966098,0.965518,0.965701,
0.965783,0.965768,0.963929,0.962968,0.963267,0.964383,0.966272,0.965428,0.964507,0.964995,
0.965980,0.964609,0.963699,0.964801,0.964164,0.964527,0.964538,0.967012,0.966683,0.963891,
0.964822,0.963297,0.964678,0.965972,0.963648,0.963659,0.964483,0.964526,0.964433,0.963657,
0.963813,0.964900,0.964354,0.965018,0.965176,0.964408,0.964067,0.963352,0.963777,0.964785,
0.964963,0.963809,0.964841,0.964728,0.963949,0.964120,0.964225,0.963705,0.963457,0.963866,
0.962370,0.962414,0.964766,0.963343,0.964265,0.965795,0.965367,0.963810,0.963857,0.964275,
0.965115,0.964713,0.964389,0.966168,0.964707,0.963218,0.963334,0.963829,0.963733,0.963283,
0.961950,0.961314,0.963585,0.964842,0.963509,0.961631,0.963943,0.965402,0.963864,0.964173,
0.964592,0.963736,0.963099,0.962910,0.963608,0.964186,0.963507,0.963141,0.963326,0.963401,
0.963502,0.963742,0.963294,0.963178,0.963512,0.963328,0.963720,0.963615,0.963306,0.963172,
0.963173,0.963163,0.963180,0.962950,0.963174,0.963208,0.963035,0.962980,0.963123,0.963137,
0.962900,0.962839,0.962921,0.963058,0.963168,0.963182,0.963034,0.962722,0.963402,0.963224,
0.963375,0.963080,0.963081,0.962964,0.962887,0.962759,0.963047,0.963234,0.963123,0.963030,
0.963193,0.963160,0.962945,0.963193,0.963268,0.963180,0.963051,0.963066,0.963084,0.963317,
0.963336,0.963177,0.963265,0.963248,0.963529,0.962853,0.962948,0.963061,0.962875,0.963016,
0.962641,0.962563,0.963206,0.963376,0.962817,0.962352,0.962475,0.962573,0.962622,0.962365,
0.962231,0.962724,0.962482,0.962275,0.962266,0.962146,0.962327,0.962208,0.961530,0.962002,
0.961929,0.961769,0.962041,0.961401,0.961941,0.961829,0.961624,0.961573,0.961633,0.961418,
0.961382,0.961163,0.961323,0.961073,0.961691,0.960748,0.961426,0.961190,0.960804,0.960975,
0.961070,0.960695,0.960600,0.960346,0.960745,0.960690,0.960528,0.961147,0.960448,0.960485,
0.960975,0.961074,0.960321,0.960490,0.961746,0.961541,0.960655,0.961256,0.960730,0.961654,
0.961352,0.960720,0.961138,0.962125,0.961773,0.961605,0.961730,0.961528,0.961760,0.961968,
0.962293,0.961882,0.962187,0.962272,0.962605,0.962276,0.962178,0.962004,0.962439,0.961771,
0.962557,0.962226,0.962073,0.962768,0.962318,0.962267,0.96137,0.961172,0.961991,0.961993,
0.961535,0.962066,0.961953,0.961941,0.961306,0.961256,0.961984,0.962036,0.961826,0.961905,
0.961480,0.961712,0.961700,0.961213,0.961450,0.961525,0.961312,0.961536,0.961388,0.960995,
0.960956,0.961216,0.961268,0.960873,0.961410,0.961625,0.960862,0.961097,0.961639,0.961348,
0.960808,0.961430,0.961889,0.961235,0.960752,0.961318,0.961461,0.960959,0.960818,0.960891,
0.961226,0.961381,0.960827,0.961158,0.961402,0.960817,0.960692,0.960954,0.961414,0.961180,
0.960672,0.960812,0.961267,0.961319,0.960750,0.960759,0.960996,0.961028,0.961149,0.961117,
0.960743,0.960830,0.960684,0.960412,0.960874,0.961091,0.961135,0.961011,0.960485,0.960639,
0.960910,0.961219,0.961211,0.961087,0.960538,0.960628,0.961248,0.961150,0.961438,0.960992,
0.960749,0.960684,0.960533,0.960797,0.960880,0.961004,0.961331,0.961036,0.960797,0.960657,
0.960848,0.961086,0.961407,0.960962,0.960587,0.960623,0.960296,0.960433,0.960823,0.960791,
0.960779,0.960470,0.959995,0.960709,0.960546,0.960597,0.961169,0.960758,0.960452,0.960417,
0.960118,0.960469,0.961248,0.960720,0.961629,0.960992,0.960780,0.961298,0.959790,0.960483,
0.960910,0.960880,0.960848,0.960707,0.961385,0.960573,0.960386,0.960548,0.960458,0.960387,
0.960484,0.960364,0.960416,0.960555,0.960055,0.960246,0.960255,0.959737,0.959755,0.959787,
0.960249,0.960162,0.959026,0.959526,0.959471,0.959545,0.960081,0.959546,0.959184,0.959452,
0.959420,0.958253,0.957867,0.959384,0.959133,0.959107,0.959644,0.958869,0.959158,0.959232,
0.959463,0.959483,0.959321,0.959115,0.959399,0.958831,0.958906,0.959329,0.958703,0.958362,
0.958250,0.958608,0.957996,0.958853,0.958113,0.958517,0.959144,0.958175,0.958094,0.958001,
0.958385,0.957945,0.958466,0.958106,0.958272,0.958229,0.958098,0.958055,0.958189,0.957801,
0.957957,0.958323,0.957379,0.957557,0.957730,0.957423,0.957673,0.957628,0.957472,0.957158,
0.957182,0.957147,0.957296,0.956990,0.956855,0.957016,0.957168,0.956682,0.956850,0.956483,
0.956033,0.956833,0.957192,0.957079,0.956858,0.956709,0.956008,0.956987,0.957469,0.956924,
0.956448,0.957100,0.957528,0.957221,0.957143,0.957036,0.957061,0.956763,0.956805,0.956910,
0.956708,0.956254,0.955824,0.957062,0.957354,0.956714,0.956168,0.957223,0.957055,0.956631,
0.957075,0.957582,0.957392,0.956532,0.956250,0.957334,0.957379,0.957405,0.957643,0.957488,
0.957547,0.957610,0.957079,0.957098,0.957803,0.957409,0.957085,0.957892,0.957882,0.957212,
0.957421,0.958094,0.957968,0.957278,0.957343,0.957778,0.957783,0.957214,0.957133,0.957601,
0.957597,0.957441,0.956679,0.956809,0.957320,0.957398,0.957742,0.957816,0.957492,0.957038,
0.957056,0.957612,0.957767,0.957653,0.956987,0.957100,0.957654,0.957474,0.957306,0.957640,
0.957604,0.957332,0.957727,0.957838,0.957892,0.957944,0.957806,0.957369,0.957237,0.957477,
0.957312,0.957805,0.957783,0.957303,0.957394,0.957203,0.956512,0.957122,0.957373,0.957098,
0.957115,0.957160,0.957250,0.957197,0.956620,0.956605,0.956858,0.956991,0.957487,0.957297,
0.956409,0.957547,0.957205,0.956793,0.956040,0.956753,0.957405,0.956880,0.956830,0.957114,
0.957157,0.957061,0.956252,0.956687,0.956816,0.957272,0.956800,0.956578,0.956938,0.956750,
0.957489,0.956641,0.956651,0.956631,0.956573,0.956345,0.956662,0.955959,0.956257,0.956198,
0.956277,0.957059,0.956165,0.956629,0.956337,0.956240,0.955337,0.955979,0.955985,0.955880,
0.955566,0.955692,0.955577,0.956194,0.955210,0.955179,0.954400,0.955801,0.955002,0.954937,
0.953346,0.956296,0.953791,0.953398,0.953977,0.954441,0.952529,0.952163,0.953877,0.951715,
0.952795,0.953839,0.951874,0.952009,0.952224,0.952145,0.951596,0.951759,0.951518,0.951063,
0.951355,0.950633,0.951277,0.950430,0.951299,0.951110,0.950450,0.950877,0.952175,0.951957,
0.950277,0.950502,0.950788,0.950966,0.951666,0.951234,0.950515,0.950197,0.951178,0.950792,
0.950823,0.949760,0.949666,0.950022,0.950039,0.950055,0.950213,0.949938,0.950221,0.950065,
0.949771,0.949734,0.950131,0.950595,0.950878,0.949492,0.949621,0.950537,0.949354,0.949169,
0.949827,0.949744,0.949814,0.950038,0.949785,0.949984,0.949508,0.949870,0.950490,0.949579,
0.949698,0.950109,0.949979,0.950453,0.949968,0.949936,0.950210,0.950466,0.949862,0.949868,
0.949908,0.950554,0.951059,0.950309,0.949774,0.950436,0.949891,0.949862,0.950304,0.950270,
0.950295,0.950045,0.950249,0.949942,0.949800,0.950122,0.950180,0.950298,0.950209,0.950644,
0.950794,0.949936,0.949987,0.950170,0.950338,0.950253,0.950642,0.950955,0.950085,0.949935,
0.951029,0.950987,0.950473,0.950464,0.950477,0.950085,0.949888,0.950698,0.950943,0.950605,
0.950515,0.950465,0.950761,0.950923,0.950235,0.950271,0.950924,0.950942,0.950844,0.950639,
0.950716,0.950941,0.950807,0.950983,0.951136,0.951087,0.951010,0.951115,0.950858,0.950879,
0.950989,0.950994,0.950932,0.950933,0.950734,0.950983,0.951078,0.950566,0.950658,0.950547,
0.950691,0.950954,0.951101,0.950928,0.951067,0.951017,0.951128,0.951234,0.952082,0.951771,
0.951263,0.951479,0.951484,0.951512,0.950404,0.950744,0.951002,0.951250,0.951924,0.951708,
0.951519,0.950741,0.951095,0.951415,0.950869,0.951686,0.951369,0.951338,0.950472,0.950987,
0.951002,0.951078,0.951829,0.951515,0.951105,0.951146,0.950510,0.950769,0.950502,0.951299,
0.951482,0.951926,0.951404,0.951146,0.951222,0.951309,0.950306,0.951232,0.951140,0.951149,
0.951372,0.950808,0.951833,0.951541,0.951251,0.951089,0.951087,0.951336,0.951727,0.951243,
0.951129,0.950627,0.951135,0.951314,0.951277,0.951268,0.951460,0.950586,0.951328,0.951439,
0.950590,0.952209,0.951403,0.951368,0.952099,0.951631,0.951352,0.951476,0.949554,0.951405,
0.950967,0.951255,0.950895,0.951982,0.950983,0.951159,0.950114,0.951165,0.951482,0.951875,
0.951285,0.951061,0.949933,0.950371,0.951774,0.951248,0.951532,0.951077,0.949929,0.950837,
0.951111,0.951524,0.950828,0.949911,0.950869,0.950467,0.950363,0.950770,0.951024,0.950490,
0.950432,0.949456,0.949683,0.950770,0.950140,0.950236,0.950799,0.950195,0.949954,0.949748,
0.949450,0.948705,0.949872,0.949679,0.949582,0.949586,0.949791,0.949936,0.949346,0.949496,
0.949119,0.948948,0.948328,0.949087,0.949101,0.948936,0.948762,0.948866,0.949113,0.948329,
0.948078,0.947425,0.947697,0.947793,0.947750,0.947997,0.947897,0.947041,0.946674,0.947218,
0.946774,0.946853,0.947088,0.945933,0.945404,0.946252,0.945889,0.946068,0.946166,0.945321,
0.944837,0.945047,0.945210,0.945556,0.945617,0.944945,0.944737,0.945218,0.945062,0.943785,
0.943746,0.945295,0.944621,0.944352,0.944465,0.944551,0.944258,0.944178,0.943422,0.943109,
0.943604,0.943551,0.943683,0.943654,0.943267,0.942171,0.942130,0.942726,0.942318,0.942932,
0.942856,0.941573,0.941385,0.941809,0.942047,0.942609,0.942406,0.941335,0.941331,0.941522,
0.941507,0.942044,0.942049,0.941066,0.941141,0.941515,0.941603,0.942384,0.942336,0.941325,
0.941625,0.941997,0.941840,0.941688,0.941821,0.942118,0.941740,0.941399,0.941486,0.941182,
0.941090,0.940494,0.939900,0.940892,0.941469,0.940934,0.940501,0.940642,0.940629,0.940646,
0.940604,0.940369,0.940361,0.940398,0.940304,0.940292,0.940732,0.940732,0.940670,0.940832,
0.940877,0.940896,0.940956,0.941078,0.941364,0.940978,0.941078,0.941217,0.941871,0.941609,
0.941569,0.941787,0.941430,0.941229,0.940711,0.941537,0.941395,0.941452,0.941780,0.941195,
0.941835,0.942267,0.941604,0.940619,0.941636,0.941174,0.941666,0.941806,0.941690,0.942700,
0.942231,0.940496,0.941571,0.941848,0.941929,0.940653,0.942056,0.942860,0.941929,0.942168,
0.941670,0.940863,0.941861,0.942739,0.942111,0.942177,0.942034,0.941992,0.942418,0.942309,
0.942668,0.942255,0.942640,0.941773,0.941157,0.941757,0.942297,0.940843,0.942567,0.941188,
0.940280,0.941507,0.941237,0.941447,0.941621,0.941953,0.940969,0.940220,0.941028,0.941935,
0.939573,0.940594,0.940902,0.942364,0.939462,0.940159,0.940079,0.940197,0.942460,0.940712,
0.940834,0.939799,0.940296,0.938730,0.939194,0.938860,0.938152,0.939125,0.939138,0.940921,
0.938283,0.938470,0.938843,0.937886,0.938431,0.937925,0.939123,0.937323,0.937770,0.937270,
0.937772,0.937601,0.937173,0.938034,0.936939,0.935867,0.936746,0.936325,0.936502,0.936650,
0.937050,0.937213,0.936453,0.936218,0.935922,0.936416,0.936432,0.936653,0.936342,0.934213,
0.935746,0.935837,0.935509,0.935065,0.934880,0.934572,0.934291,0.933965,0.933642,0.932521,
0.931764,0.933334,0.933285,0.933300,0.933587,0.933888,0.934188,0.934129,0.934366,0.934504,
0.934439,0.934421,0.934412,0.934307,0.934642,0.934829,0.933566,0.933530,0.934291,0.933371,
0.932418,0.932267,0.933526,0.933204,0.931983,0.932074,0.931911,0.931649,0.932109,0.931845,
0.930827,0.931113,0.931204,0.930897,0.931021,0.931174,0.931073,0.931095,0.930797,0.931354,
0.931551,0.931374,0.931267,0.930925,0.929991,0.929516,0.929904,0.930383,0.929537,0.929188,
0.930388,0.930306,0.928962,0.929112,0.929338,0.930088,0.929471,0.929075,0.929389,0.929536,
0.930345,0.930224,0.929904,0.929542,0.930350,0.930417,0.929894,0.929807,0.930659,0.930598,
0.930953,0.930772,0.930616,0.930458,0.931435,0.931469,0.930804,0.931322,0.931774,0.931687,
0.930816,0.931000,0.931910,0.931106,0.930932,0.931732,0.930664,0.930060,0.931153,0.931198,
0.930254,0.930816,0.930770,0.930436,0.931481,0.930455,0.930684,0.930996,0.930785,0.931012,
0.931014,0.930897,0.930787,0.930974,0.930689,0.930646,0.930579,0.929648,0.930906,0.930014,
0.930413,0.928679,0.928757,0.927823,0.929371,0.927982,0.929182,0.926819,0.929435,0.926809,
0.925992,0.927580,0.927157,0.927000,0.926570,0.926909,0.925525,0.927537,0.927161,0.925385,
0.925759,0.926084,0.927091,0.927072,0.923526,0.924990,0.925658,0.924533,0.925798,0.922558,
0.924825,0.923841,0.922504,0.924564,0.924509,0.921838,0.921984,0.923968,0.921909,0.922115,
0.920727,0.922846,0.922311,0.918619,0.920271,0.921516,0.919717,0.918877,0.919406,0.919429,
0.918917,0.918289,0.918523,0.918497,0.917147,0.919189,0.918103,0.918228,0.917655,0.917516,
0.917194,0.917810,0.918549,0.916581,0.918735,0.916087,0.916137,0.917525,0.917624,0.915666,
0.915528,0.916519,0.915247,0.916782,0.916104,0.913691,0.915848,0.916726,0.913358,0.915180,
0.916265,0.914883,0.913765,0.915503,0.915008,0.912844,0.914004,0.914927,0.914461,0.913188,
0.913318,0.912905,0.913736,0.914370,0.914433,0.912314,0.914269,0.913418,0.912490,0.913412,
0.914662,0.912603,0.911481,0.911597,0.912321,0.912903,0.912407,0.911133,0.910208,0.910118,
0.910912,0.911530,0.910730,0.909060,0.909813,0.910061,0.911527,0.910316,0.908750,0.907563,
0.909057,0.910276,0.908066,0.907124,0.908051,0.907425,0.908294,0.906601,0.905394,0.906569,
0.906724,0.904694,0.903268,0.905102,0.905896,0.903578,0.902255,0.903611,0.903962,0.901771,
0.900795,0.902178,0.901847,0.900218,0.899707,0.900641,0.900271,0.899280,0.898514,0.897931,
0.898682,0.898695,0.897256,0.897166,0.898268,0.898213,0.897110,0.897696,0.897889,0.897896,
0.898257,0.897502,0.897599,0.898413,0.898598,0.898897,0.899073,0.899596,0.899912,0.900032,
0.899831,0.899312,0.899578,0.901041,0.901296,0.901175,0.901919,0.901951,0.901746,0.901615,
0.902415,0.903312,0.903966,0.904879,0.904675,0.905811,0.907419,0.908028,0.906999,0.908750,
0.909615,0.910783,0.910714,0.910459,0.910745,0.912254,0.912109,0.912238,0.911737,0.912905,
0.913662,0.913784,0.913691,0.913526,0.914629,0.915040,0.915865,0.916182,0.916428,0.916792,
0.916391,0.916332,0.918203,0.918134,0.918501,0.918579,0.919135,0.918980,0.919064,0.919229,
0.919782,0.919747,0.919515,0.920777,0.920407,0.920141,0.919103,0.919949,0.920581,0.920823,
0.920683,0.921276,0.921643,0.921141,0.922045,0.920314,0.920383,0.921183,0.920967,0.922155,
0.921971,0.919313,0.920994,0.922126,0.921108,0.920579,0.919698,0.920712,0.921968,0.919263,
0.920523,0.921067,0.920350,0.919178,0.920637,0.919833,0.918850,0.921603,0.920560,0.917578,
0.920075,0.920342,0.919300,0.919090,0.918563,0.918526,0.917418,0.919589,0.918033,0.917122,
0.917604,0.918301,0.915801,0.917840,0.916340,0.915206,0.915990,0.916889,0.915702,0.914432,
0.915299,0.916516,0.915052,0.913779,0.914535,0.917185,0.915868,0.914090,0.914082,0.914804,
0.914778,0.914491,0.914113,0.913967,0.914199,0.914667,0.914329,0.913189,0.912686,0.912742,
0.912826,0.912790,0.912861,0.913041,0.913410,0.913410,0.913349,0.913838,0.914417,0.914234,
0.914065,0.913928,0.914009,0.913949,0.913509,0.913155,0.912722,0.912600,0.912284,0.911867,
0.911315,0.911379,0.911143,0.911241,0.911016,0.911001,0.910915,0.910845,0.910491,0.910502,
0.910212,0.909450,0.909439,0.909216,0.908789,0.908068,0.907703,0.907228,0.906937,0.906285,
0.905893,0.905843,0.905545,0.905040,0.904906,0.904593,0.904606,0.904215,0.903517,0.903307,
0.903074,0.902587,0.901816,0.901126,0.901064,0.900789,0.900209,0.899505,0.899211,0.899021,
0.898899,0.898316,0.897902,0.897798,0.897628,0.897472,0.897392,0.897195,0.897510,0.897682,
0.897245,0.897108,0.897119,0.896369,0.896054,0.895860,0.895458,0.895390,0.895644,0.895142,
0.894973,0.894928,0.894704,0.894828,0.894913,0.894849,0.894971,0.894672,0.894655,0.894979,
0.895145,0.895347,0.895101,0.895388,0.894732,0.894415,0.894377,0.894023,0.894181,0.893652,
0.893034,0.893021,0.892627,0.892403,0.892350,0.891762,0.892175,0.892122,0.891785,0.891497,
0.892136,0.891550,0.891697,0.891783,0.891863,0.891103,0.891803,0.891994,0.891058,0.890471,
0.890172,0.889618,0.889267,0.887640,0.887164,0.886331,0.885732,0.885313,0.885159,0.885268,
0.884852,0.884361,0.885015,0.885018,0.885179,0.885627,0.885599,0.886269,0.886405,0.886051,
0.887398,0.886760,0.885634,0.885678,0.884955,0.884698,0.884464,0.883651,0.884251,0.883859,
0.883695,0.884502,0.885360,0.885706,0.885301,0.886630,0.887173,0.887959,0.888513,0.888462,
0.889262,0.890599,0.889916,0.889301,0.890386,0.888856,0.889094,0.888942,0.888969,0.887626,
0.887455}; // [frc] 10 reflectances per line, 2201 total
  
/* [nbr] Number of wavelengths in factory calibration of spectralon reference
   NB: *_srb variables are from Shawn Serbin and refer to his SphereOptics standard which
   is not a part of Terraref. Shawn provided these as demonstration before Terraref's were available.
   Shawn's are now deprecated for Terraref and only kept in this file to demonstrate
   inter-standard calibration range */
*wvl_srb_nbr=2251;
defdim("wvl_srb",wvl_srb_nbr);
wvl_srb[wvl_srb]=0.0f; // [m]
wvl_srb@long_name="Wavelength of factory calibration of Shawn Serbin's standard";
wvl_srb@standard_name="sensor_band_central_radiation_wavelength";
wvl_srb@units="meter";
wvl_srb@provenance="Factory calibration of SphereOptics part #99AA02-0316-4214 received from @serbinsh Shawn Serbin <sserbin@bnl.gov>. Data are 2251 absolute calibrated reflectances at 1 nm resolution from 250--2500 nm. More information at https://github.com/terraref/reference-data/issues/53#issuecomment-249925142";
wvl_srb=array(250.0,1.0,$wvl_srb);
// Change calibration wavelengths from nm to m (SI)
wvl_srb*=1.0e-9; // [m]

/* 20160927: Factory calibration of SphereOptics part #99AA02-0316-4214 received from @serbinsh Shawn Serbin <sserbin@bnl.gov> 
   Data are 2251 absolute calibrated reflectances at 1 nm resolution from 250--2500 nm
   More information at https://github.com/terraref/reference-data/issues/53#issuecomment-249925142 */
*factory_calibrated_reflectance_srb[wvl_srb]={ // [frc] 10 wavelengths per line, 2251 total
0.9618,0.9622,0.9633,0.9638,0.9645,0.9641,0.9647,0.9644,0.9650,0.9646,
0.9648,0.9655,0.9659,0.9668,0.9661,0.9669,0.9672,0.9665,0.9671,0.9678,
0.9672,0.9659,0.9660,0.9673,0.9682,0.9676,0.9690,0.9695,0.9705,0.9705,
0.9693,0.9702,0.9703,0.9707,0.9721,0.9728,0.9738,0.9729,0.9748,0.9754,
0.9765,0.9759,0.9755,0.9769,0.9778,0.9779,0.9783,0.9781,0.9802,0.9796,
0.9796,0.9790,0.9805,0.9800,0.9792,0.9813,0.9812,0.9822,0.9825,0.9818,
0.9831,0.9828,0.9823,0.9829,0.9820,0.9830,0.9825,0.9827,0.9847,0.9866,
0.9873,0.9884,0.9871,0.9882,0.9886,0.9883,0.9873,0.9875,0.9885,0.9874,
0.9871,0.9882,0.9878,0.9881,0.9884,0.9887,0.9886,0.9891,0.9889,0.9882,
0.9877,0.9882,0.9892,0.9889,0.9891,0.9889,0.9885,0.9884,0.9888,0.9889,
0.9893,0.9892,0.9887,0.9885,0.9890,0.9895,0.9887,0.9885,0.9891,0.9892,
0.9892,0.9889,0.9886,0.9893,0.9893,0.9897,0.9896,0.9901,0.9901,0.9898,
0.9906,0.9911,0.9908,0.9900,0.9909,0.9925,0.9924,0.9911,0.9903,0.9896,
0.9889,0.9889,0.9897,0.9891,0.9885,0.9905,0.9912,0.9911,0.9911,0.9909,
0.9907,0.9903,0.9904,0.9903,0.9905,0.9912,0.9913,0.9914,0.9912,0.9920,
0.9918,0.9913,0.9912,0.9910,0.9910,0.9907,0.9910,0.9918,0.9922,0.9913,
0.9909,0.9912,0.9913,0.9919,0.9916,0.9910,0.9915,0.9915,0.9912,0.9916,
0.9919,0.9917,0.9914,0.9911,0.9916,0.9916,0.9920,0.9920,0.9915,0.9913,
0.9918,0.9920,0.9917,0.9916,0.9915,0.9918,0.9915,0.9912,0.9913,0.9913,
0.9915,0.9919,0.9920,0.9920,0.9919,0.9915,0.9910,0.9910,0.9912,0.9907,
0.9911,0.9913,0.9913,0.9921,0.9917,0.9916,0.9916,0.9915,0.9913,0.9909,
0.9912,0.9914,0.9917,0.9912,0.9914,0.9912,0.9912,0.9913,0.9914,0.9919,
0.9917,0.9916,0.9914,0.9926,0.9924,0.9924,0.9925,0.9924,0.9928,0.9928,
0.9928,0.9928,0.9921,0.9923,0.9922,0.9919,0.9916,0.9916,0.9917,0.9918,
0.9921,0.9921,0.9917,0.9917,0.9919,0.9917,0.9919,0.9919,0.9913,0.9919,
0.9919,0.9915,0.9917,0.9920,0.9919,0.9916,0.9922,0.9921,0.9925,0.9920,
0.9922,0.9923,0.9925,0.9928,0.9925,0.9926,0.9926,0.9927,0.9925,0.9924,
0.9924,0.9928,0.9931,0.9925,0.9933,0.9929,0.9925,0.9933,0.9927,0.9929,
0.9927,0.9932,0.9931,0.9928,0.9933,0.9926,0.9928,0.9934,0.9934,0.9928,
0.9926,0.9924,0.9925,0.9929,0.9925,0.9929,0.9930,0.9929,0.9927,0.9928,
0.9930,0.9927,0.9929,0.9927,0.9923,0.9931,0.9923,0.9931,0.9926,0.9930,
0.9929,0.9926,0.9924,0.9920,0.9927,0.9931,0.9928,0.9930,0.9929,0.9925,
0.9930,0.9927,0.9927,0.9927,0.9924,0.9927,0.9931,0.9934,0.9925,0.9927,
0.9926,0.9929,0.9924,0.9922,0.9927,0.9928,0.9928,0.9924,0.9925,0.9927,
0.9927,0.9928,0.9927,0.9928,0.9931,0.9933,0.9929,0.9927,0.9926,0.9927,
0.9927,0.9924,0.9925,0.9928,0.9929,0.9926,0.9926,0.9929,0.9927,0.9930,
0.9924,0.9930,0.9930,0.9928,0.9925,0.9923,0.9928,0.9932,0.9931,0.9930,
0.9924,0.9928,0.9932,0.9928,0.9929,0.9928,0.9924,0.9924,0.9928,0.9926,
0.9923,0.9924,0.9924,0.9923,0.9928,0.9926,0.9926,0.9926,0.9927,0.9923,
0.9922,0.9926,0.9927,0.9928,0.9926,0.9928,0.9928,0.9925,0.9925,0.9928,
0.9930,0.9925,0.9922,0.9925,0.9926,0.9925,0.9922,0.9923,0.9925,0.9928,
0.9929,0.9932,0.9928,0.9928,0.9930,0.9926,0.9925,0.9925,0.9930,0.9927,
0.9922,0.9922,0.9927,0.9932,0.9928,0.9925,0.9925,0.9928,0.9931,0.9932,
0.9927,0.9925,0.9926,0.9925,0.9921,0.9923,0.9929,0.9928,0.9925,0.9930,
0.9931,0.9926,0.9928,0.9929,0.9930,0.9928,0.9926,0.9931,0.9933,0.9929,
0.9926,0.9922,0.9924,0.9927,0.9929,0.9930,0.9924,0.9925,0.9930,0.9932,
0.9928,0.9923,0.9929,0.9929,0.9922,0.9922,0.9924,0.9922,0.9926,0.9928,
0.9925,0.9923,0.9927,0.9926,0.9916,0.9923,0.9927,0.9923,0.9920,0.9921,
0.9922,0.9924,0.9924,0.9927,0.9924,0.9924,0.9920,0.9913,0.9924,0.9917,
0.9920,0.9928,0.9928,0.9928,0.9918,0.9922,0.9919,0.9922,0.9916,0.9921,
0.9922,0.9923,0.9925,0.9919,0.9918,0.9925,0.9927,0.9923,0.9922,0.9921,
0.9921,0.9929,0.9932,0.9929,0.9925,0.9925,0.9914,0.9919,0.9920,0.9919,
0.9930,0.9930,0.9931,0.9921,0.9918,0.9912,0.9919,0.9917,0.9916,0.9922,
0.9916,0.9915,0.9926,0.9925,0.9923,0.9919,0.9917,0.9918,0.9929,0.9931,
0.9919,0.9927,0.9920,0.9930,0.9906,0.9917,0.9913,0.9924,0.9937,0.9924,
0.9904,0.9924,0.9931,0.9932,0.9912,0.9926,0.9913,0.9912,0.9919,0.9922,
0.9922,0.9925,0.9924,0.9922,0.9916,0.9921,0.9909,0.9927,0.9918,0.9923,
0.9936,0.9919,0.9910,0.9931,0.9915,0.9916,0.9930,0.9928,0.9926,0.9912,
0.9919,0.9943,0.9931,0.9946,0.9927,0.9914,0.9923,0.9928,0.9930,0.9922,
0.9928,0.9945,0.9921,0.9932,0.9937,0.9935,0.9937,0.9949,0.9939,0.9937,
0.9916,0.9960,0.9944,0.9907,0.9939,0.9917,0.9940,0.9930,0.9918,0.9943,
0.9864,0.9850,0.9975,0.9890,0.9897,0.9932,0.9913,0.9979,0.9949,0.9911,
0.9912,0.9823,0.9905,0.9888,0.9840,0.9936,0.9900,0.9908,0.9898,0.9881,
0.9909,0.9931,0.9921,0.9879,0.9983,0.9921,0.9917,0.9871,0.9888,0.9936,
0.9936,0.9944,0.9902,0.9889,0.9915,0.9926,0.9920,0.9968,0.9924,0.9925,
0.9920,0.9936,0.9936,0.9921,0.9922,0.9929,0.9934,0.9927,0.9921,0.9916,
0.9927,0.9943,0.9954,0.9924,0.9894,0.9922,0.9921,0.9943,0.9915,0.9911,
0.9916,0.9930,0.9924,0.9916,0.9926,0.9942,0.9940,0.9928,0.9922,0.9920,
0.9918,0.9919,0.9920,0.9927,0.9935,0.9927,0.9925,0.9924,0.9936,0.9934,
0.9929,0.9936,0.9926,0.9929,0.9925,0.9934,0.9939,0.9932,0.9926,0.9926,
0.9918,0.9925,0.9921,0.9922,0.9920,0.9924,0.9927,0.9925,0.9924,0.9932,
0.9927,0.9914,0.9916,0.9922,0.9920,0.9923,0.9922,0.9919,0.9923,0.9931,
0.9930,0.9930,0.9937,0.9942,0.9939,0.9933,0.9936,0.9935,0.9940,0.9941,
0.9936,0.9933,0.9936,0.9937,0.9938,0.9940,0.9940,0.9938,0.9934,0.9935,
0.9939,0.9943,0.9943,0.9933,0.9932,0.9932,0.9931,0.9933,0.9935,0.9936,
0.9934,0.9934,0.9933,0.9931,0.9937,0.9943,0.9944,0.9940,0.9926,0.9923,
0.9930,0.9933,0.9938,0.9937,0.9934,0.9933,0.9931,0.9932,0.9937,0.9934,
0.9928,0.9931,0.9933,0.9935,0.9937,0.9937,0.9936,0.9933,0.9934,0.9937,
0.9935,0.9932,0.9929,0.9933,0.9935,0.9932,0.9933,0.9934,0.9934,0.9934,
0.9933,0.9934,0.9934,0.9936,0.9935,0.9936,0.9938,0.9933,0.9931,0.9932,
0.9937,0.9938,0.9936,0.9933,0.9933,0.9934,0.9934,0.9935,0.9936,0.9935,
0.9934,0.9930,0.9930,0.9932,0.9932,0.9927,0.9933,0.9932,0.9932,0.9935,
0.9935,0.9935,0.9935,0.9935,0.9935,0.9933,0.9932,0.9928,0.9926,0.9928,
0.9926,0.9925,0.9928,0.9931,0.9931,0.9932,0.9928,0.9929,0.9927,0.9933,
0.9933,0.9931,0.9930,0.9926,0.9929,0.9933,0.9931,0.9930,0.9928,0.9929,
0.9932,0.9933,0.9932,0.9933,0.9935,0.9933,0.9936,0.9934,0.9931,0.9928,
0.9928,0.9934,0.9932,0.9927,0.9931,0.9935,0.9936,0.9931,0.9932,0.9934,
0.9933,0.9936,0.9931,0.9935,0.9933,0.9934,0.9934,0.9932,0.9939,0.9932,
0.9928,0.9929,0.9932,0.9932,0.9931,0.9933,0.9931,0.9933,0.9929,0.9933,
0.9932,0.9932,0.9931,0.9929,0.9924,0.9931,0.9929,0.9929,0.9929,0.9934,
0.9930,0.9935,0.9931,0.9932,0.9933,0.9928,0.9929,0.9930,0.9932,0.9932,
0.9931,0.9934,0.9932,0.9930,0.9928,0.9935,0.9928,0.9929,0.9931,0.9928,
0.9932,0.9931,0.9932,0.9934,0.9933,0.9935,0.9925,0.9923,0.9921,0.9921,
0.9919,0.9919,0.9926,0.9925,0.9919,0.9919,0.9924,0.9920,0.9926,0.9926,
0.9920,0.9922,0.9922,0.9922,0.9922,0.9923,0.9919,0.9922,0.9924,0.9924,
0.9918,0.9917,0.9920,0.9917,0.9919,0.9919,0.9923,0.9923,0.9918,0.9919,
0.9921,0.9919,0.9917,0.9919,0.9917,0.9920,0.9920,0.9919,0.9921,0.9918,
0.9919,0.9920,0.9921,0.9922,0.9922,0.9921,0.9922,0.9919,0.9919,0.9921,
0.9918,0.9921,0.9923,0.9923,0.9920,0.9924,0.9922,0.9919,0.9920,0.9921,
0.9918,0.9919,0.9918,0.9919,0.9920,0.9923,0.9922,0.9921,0.9922,0.9923,
0.9919,0.9922,0.9925,0.9921,0.9920,0.9920,0.9919,0.9918,0.9921,0.9922,
0.9920,0.9917,0.9918,0.9920,0.9919,0.9923,0.9923,0.9919,0.9919,0.9919,
0.9921,0.9920,0.9917,0.9917,0.9918,0.9920,0.9909,0.9909,0.9910,0.9911,
0.9911,0.9911,0.9909,0.9910,0.9912,0.9910,0.9908,0.9910,0.9912,0.9911,
0.9912,0.9912,0.9911,0.9912,0.9914,0.9913,0.9911,0.9909,0.9910,0.9911,
0.9911,0.9909,0.9908,0.9911,0.9908,0.9906,0.9909,0.9911,0.9910,0.9909,
0.9908,0.9911,0.9913,0.9910,0.9910,0.9911,0.9910,0.9909,0.9906,0.9908,
0.9909,0.9909,0.9912,0.9914,0.9910,0.9909,0.9899,0.9896,0.9896,0.9896,
0.9899,0.9901,0.9900,0.9899,0.9898,0.9897,0.9897,0.9898,0.9899,0.9898,
0.9898,0.9899,0.9900,0.9902,0.9898,0.9897,0.9899,0.9900,0.9900,0.9899,
0.9899,0.9903,0.9901,0.9898,0.9901,0.9906,0.9915,0.9919,0.9912,0.9908,
0.9907,0.9905,0.9905,0.9907,0.9906,0.9903,0.9899,0.9900,0.9900,0.9903,
0.9899,0.9892,0.9893,0.9893,0.9893,0.9895,0.9895,0.9897,0.9899,0.9902,
0.9903,0.9902,0.9905,0.9900,0.9896,0.9900,0.9897,0.9898,0.9900,0.9899,
0.9897,0.9892,0.9893,0.9899,0.9900,0.9897,0.9895,0.9896,0.9899,0.9900,
0.9901,0.9897,0.9898,0.9899,0.9899,0.9894,0.9900,0.9897,0.9894,0.9897,
0.9900,0.9896,0.9896,0.9895,0.9894,0.9897,0.9900,0.9902,0.9899,0.9897,
0.9898,0.9897,0.9897,0.9896,0.9893,0.9905,0.9906,0.9910,0.9908,0.9909,
0.9913,0.9911,0.9909,0.9905,0.9905,0.9908,0.9913,0.9914,0.9915,0.9913,
0.9913,0.9908,0.9915,0.9912,0.9909,0.9908,0.9911,0.9909,0.9916,0.9912,
0.9915,0.9917,0.9909,0.9909,0.9905,0.9906,0.9915,0.9908,0.9912,0.9911,
0.9911,0.9908,0.9909,0.9908,0.9910,0.9910,0.9908,0.9911,0.9915,0.9906,
0.9916,0.9910,0.9904,0.9909,0.9911,0.9911,0.9911,0.9907,0.9908,0.9903,
0.9905,0.9905,0.9909,0.9905,0.9908,0.9908,0.9916,0.9906,0.9910,0.9910,
0.9912,0.9905,0.9908,0.9909,0.9910,0.9912,0.9903,0.9910,0.9917,0.9911,
0.9912,0.9910,0.9908,0.9909,0.9914,0.9909,0.9912,0.9913,0.9909,0.9915,
0.9913,0.9907,0.9903,0.9909,0.9914,0.9913,0.9905,0.9902,0.9905,0.9904,
0.9911,0.9906,0.9911,0.9907,0.9908,0.9903,0.9906,0.9910,0.9906,0.9913,
0.9907,0.9906,0.9907,0.9907,0.9911,0.9909,0.9912,0.9909,0.9912,0.9907,
0.9907,0.9906,0.9905,0.9907,0.9909,0.9914,0.9912,0.9912,0.9924,0.9912,
0.9901,0.9907,0.9906,0.9912,0.9907,0.9910,0.9910,0.9911,0.9909,0.9907,
0.9911,0.9909,0.9909,0.9906,0.9908,0.9904,0.9907,0.9914,0.9915,0.9916,
0.9913,0.9904,0.9891,0.9892,0.9892,0.9886,0.9886,0.9889,0.9903,0.9914,
0.9906,0.9908,0.9923,0.9927,0.9922,0.9920,0.9925,0.9925,0.9922,0.9914,
0.9920,0.9912,0.9914,0.9908,0.9915,0.9909,0.9909,0.9918,0.9912,0.9909,
0.9903,0.9906,0.9911,0.9906,0.9907,0.9909,0.9908,0.9908,0.9907,0.9907,
0.9908,0.9913,0.9910,0.9910,0.9905,0.9908,0.9910,0.9913,0.9911,0.9908,
0.9912,0.9916,0.9910,0.9912,0.9909,0.9905,0.9901,0.9899,0.9892,0.9894,
0.9897,0.9899,0.9904,0.9906,0.9899,0.9897,0.9900,0.9897,0.9898,0.9901,
0.9901,0.9895,0.9894,0.9896,0.9896,0.9898,0.9903,0.9899,0.9896,0.9893,
0.9893,0.9897,0.9898,0.9900,0.9898,0.9890,0.9887,0.9891,0.9891,0.9892,
0.9893,0.9889,0.9897,0.9894,0.9900,0.9910,0.9913,0.9915,0.9902,0.9889,
0.9889,0.9893,0.9890,0.9887,0.9884,0.9882,0.9875,0.9877,0.9876,0.9874,
0.9873,0.9876,0.9878,0.9871,0.9874,0.9882,0.9880,0.9873,0.9877,0.9878,
0.9879,0.9887,0.9879,0.9882,0.9885,0.9877,0.9871,0.9874,0.9874,0.9873,
0.9887,0.9884,0.9874,0.9868,0.9869,0.9877,0.9869,0.9873,0.9879,0.9881,
0.9870,0.9875,0.9881,0.9879,0.9872,0.9876,0.9878,0.9869,0.9861,0.9863,
0.9875,0.9876,0.9878,0.9879,0.9866,0.9870,0.9869,0.9869,0.9867,0.9868,
0.9875,0.9872,0.9866,0.9874,0.9871,0.9865,0.9877,0.9879,0.9874,0.9870,
0.9855,0.9873,0.9877,0.9869,0.9864,0.9865,0.9876,0.9878,0.9873,0.9871,
0.9883,0.9881,0.9879,0.9871,0.9879,0.9878,0.9872,0.9873,0.9865,0.9858,
0.9857,0.9861,0.9863,0.9856,0.9860,0.9869,0.9871,0.9870,0.9866,0.9858,
0.9860,0.9866,0.9865,0.9870,0.9871,0.9883,0.9876,0.9872,0.9876,0.9882,
0.9867,0.9878,0.9875,0.9880,0.9880,0.9872,0.9872,0.9878,0.9877,0.9881,
0.9868,0.9877,0.9876,0.9872,0.9866,0.9881,0.9884,0.9884,0.9877,0.9869,
0.9870,0.9878,0.9870,0.9869,0.9872,0.9881,0.9869,0.9851,0.9853,0.9865,
0.9851,0.9872,0.9862,0.9864,0.9840,0.9831,0.9883,0.9901,0.9885,0.9842,
0.9859,0.9857,0.9865,0.9853,0.9850,0.9870,0.9840,0.9861,0.9860,0.9855,
0.9850,0.9845,0.9842,0.9851,0.9833,0.9828,0.9830,0.9830,0.9828,0.9857,
0.9861,0.9871,0.9860,0.9839,0.9842,0.9830,0.9824,0.9819,0.9809,0.9834,
0.9848,0.9836,0.9819,0.9830,0.9829,0.9841,0.9850,0.9829,0.9830,0.9825,
0.9820,0.9812,0.9827,0.9832,0.9840,0.9817,0.9807,0.9834,0.9817,0.9825,
0.9833,0.9844,0.9841,0.9832,0.9837,0.9829,0.9810,0.9820,0.9795,0.9798,
0.9790,0.9808,0.9819,0.9799,0.9797,0.9807,0.9787,0.9799,0.9810,0.9834,
0.9833,0.9834,0.9846,0.9773,0.9787,0.9809,0.9796,0.9804,0.9818,0.9803,
0.9794,0.9766,0.9824,0.9832,0.9837,0.9809,0.9772,0.9807,0.9804,0.9808,
0.9822,0.9796,0.9786,0.9798,0.9796,0.9801,0.9817,0.9796,0.9807,0.9819,
0.9805,0.9781,0.9793,0.9782,0.9807,0.9813,0.9792,0.9783,0.9782,0.9797,
0.9815,0.9811,0.9806,0.9774,0.9770,0.9800,0.9779,0.9786,0.9769,0.9794,
0.9814,0.9796,0.9757,0.9741,0.9796,0.9797,0.9802,0.9779,0.9752,0.9781,
0.9797,0.9813,0.9828,0.9802,0.9797,0.9807,0.9799,0.9784,0.9783,0.9801,
0.9784,0.9772,0.9782,0.9781,0.9785,0.9785,0.9778,0.9770,0.9783,0.9787,
0.9767,0.9780,0.9794,0.9785,0.9781,0.9782,0.9763,0.9783,0.9786,0.9762,
0.9773,0.9782,0.9770,0.9762,0.9765,0.9770,0.9763,0.9758,0.9766,0.9768,
0.9769,0.9757,0.9744,0.9741,0.9733,0.9751,0.9769,0.9773,0.9780,0.9774,
0.9727,0.9698,0.9730,0.9743,0.9757,0.9741,0.9714,0.9725,0.9711,0.9723,
0.9728,0.9714,0.9705,0.9700,0.9704,0.9702,0.9666,0.9640,0.9682,0.9741,
0.9761,0.9741,0.9704,0.9679,0.9694,0.9696,0.9678,0.9661,0.9675,0.9678,
0.9661,0.9649,0.9659,0.9656,0.9656,0.9658,0.9640,0.9641,0.9648,0.9636,
0.9644,0.9663,0.9652,0.9637,0.9624,0.9610,0.9624,0.9621,0.9613,0.9614,
0.9598,0.9603,0.9605,0.9615,0.9596,0.9621,0.9620,0.9623,0.9613,0.9619,
0.9596,0.9590,0.9607,0.9606,0.9606,0.9619,0.9584,0.9589,0.9596,0.9578,
0.9579,0.9567,0.9550,0.9571,0.9568,0.9545,0.9554,0.9575,0.9583,0.9561,
0.9550,0.9553,0.9542,0.9553,0.9576,0.9592,0.9573,0.9555,0.9543,0.9553,
0.9576,0.9563,0.9516,0.9534,0.9530,0.9527,0.9561,0.9533,0.9511,0.9528,
0.9505,0.9497,0.9535,0.9519,0.9543,0.9535,0.9534,0.9523,0.9529,0.9498,
0.9514,0.9500,0.9513,0.9502,0.9504,0.9506,0.9492,0.9459,0.9475,0.9507,
0.9455,0.9438,0.9457,0.9522,0.9503,0.9516,0.9518,0.9520,0.9503,0.9466,
0.9420,0.9501,0.9477,0.9451,0.9435,0.9456,0.9423,0.9441,0.9490,0.9454,
0.9479,0.9472,0.9461,0.9441,0.9474,0.9461,0.9441,0.9443,0.9491,0.9456,
0.9447,0.9517,0.9461,0.9455,0.9562,0.9505,0.9475,0.9456,0.9532,0.9517,
0.9451,0.9481,0.9529,0.9563,0.9528,0.9554,0.9528,0.9534,0.9505,0.9578,
0.9542,0.9523,0.9589,0.9591,0.9589,0.9593,0.9591,0.9566,0.9538,0.9579,
0.9561,0.9615,0.9581,0.9598,0.9629,0.9593,0.9586,0.9627,0.9620,0.9661,
0.9596,0.9638,0.9634,0.9657,0.9611,0.9677,0.9649,0.9636,0.9633,0.9646,
0.9688,0.9687,0.9645,0.9618,0.9696,0.9664,0.9628,0.9650,0.9649,0.9630,
0.9652,0.9657,0.9640,0.9669,0.9625,0.9612,0.9637,0.9686,0.9668,0.9663,
0.9685,0.9684,0.9652,0.9657,0.9612,0.9661,0.9670,0.9721,0.9717,0.9646,
0.9697,0.9683,0.9671,0.9674,0.9648,0.9705,0.9698,0.9658,0.9657,0.9675,
0.9664,0.9734,0.9714,0.9648,0.9676,0.9627,0.9630,0.9663,0.9712,0.9616,
0.9679,0.9634,0.9666,0.9641,0.9622,0.9667,0.9661,0.9650,0.9611,0.9631,
0.9664,0.9653,0.9653,0.9643,0.9656,0.9651,0.9615,0.9562,0.9620,0.9640,
0.9660,0.9658,0.9668,0.9654,0.9719,0.9659,0.9608,0.9641,0.9660,0.9629,
0.9579,0.9613,0.9637,0.9680,0.9616,0.9599,0.9596,0.9569,0.9602,0.9613,
0.9610,0.9587,0.9579,0.9523,0.9582,0.9648,0.9650,0.9668,0.9649,0.9557,
0.9548,0.9528,0.9581,0.9600,0.9608,0.9516,0.9453,0.9482,0.9564,0.9669,
0.9631,0.9506,0.9465,0.9487,0.9501,0.9554,0.9598,0.9562,0.9524,0.9523,
0.9586,0.9596,0.9515,0.9533,0.9532,0.9473,0.9413,0.9411,0.9502,0.9490,
0.9480,0.9485,0.9489,0.9530,0.9478,0.9482,0.9477,0.9444,0.9482,0.9531,
0.9598,0.9469,0.9375,0.9502,0.9569,0.9607,0.9601,0.9498,0.9434,0.9462,
0.9505,0.9555,0.9546,0.9486,0.9522,0.9462,0.9377,0.9406,0.9395,0.9439,
0.9485,0.9521,0.9425,0.9367,0.9468,0.9443,0.9449,0.9491,0.9438,0.9375,
0.9406,0.9374,0.9394,0.9497,0.9436,0.9408,0.9407,0.9514,0.9550,0.9480,
0.9440,0.9343,0.9322,0.9378,0.9414,0.9461,0.9353,0.9388,0.9433,0.9448,
0.9480,0.9361,0.9412,0.9464,0.9548,0.9525,0.9444,0.9441,0.9473,0.9430,
0.9377,0.9406,0.9384,0.9420,0.9531,0.9385,0.9390,0.9384,0.9318,0.9305,
0.9399,0.9441,0.9506,0.9489,0.9382,0.9319,0.9403,0.9448,0.9458,0.9378,
0.9446,0.9414,0.9265,0.9277,0.9285,0.9362,0.9326,0.9429,0.9441,0.9444,
0.9503,0.9456,0.9450,0.9525,0.9375,0.9284,0.9299,0.9322,0.9331,0.9326,
0.9327,0.9367,0.9360,0.9369,0.9491,0.9357,0.9339,0.9388,0.9406,0.9469,
0.9351,0.9382,0.9480,0.9368,0.9339,0.9382,0.9470,0.9410,0.9318,0.9355,
0.9529,0.9402,0.9238,0.9334,0.9401,0.9448,0.9471,0.9434,0.9406,0.9497,
0.9348,0.9349,0.9387,0.9601,0.9399,0.9434,0.9504,0.9499,0.9298,0.9505,
0.9621,0.9390,0.9501,0.9375,0.9217,0.9336,0.9376,0.9423,0.9462,0.9288,
0.9303,0.9339,0.9527,0.9371,0.9524,0.9458,0.9163,0.9445,0.9340,0.9393,
0.9365}; // end factory_calibrated_reflectance[wvl_srb] 10 reflectances per line, 2251 total
  
/* fxm: Interpolate factory calibration of spectralon target to wavelength grid of current instrument (VNIR, SWIR) */

/* exposure_reference is exposure measured when pointing at spectralon reference target
   Camera exposed to natural light reflecting from reference target for standard exposure time accumulates exposure_reference counts in each channel
   Expected to be large fraction (assumed here to be fake_factory_calibrate_reflectance) of exposure_theoretical_maximum for white reflector 
   However, grey reference reflector might be more optimal than white
   Plants have maximum reflectance of ~0.4 so calibrating at white not as accurate as calibrating near 0.4 
   We hope Lemnatec tunes exposure time to achieve the greatest dynamic range, and thus precision, under a wide range of circumstances
   One tuning consideration is that maximum exposure for white reflector at noon is close to but does not exceed exposure_theoretical_maximum 
   Other tuning considerations are possible... */
// 20160908: actual values are not yet available so use this guesstimate
*exposure_reference_guesstimate=ushort(factory_calibrated_reflectance_guesstimate*exposure_theoretical_maximum); // [cnt]
*maximum_plant_reflectance_guesstimate=0.37; // [frc]

// A perfect detector would measure no counts when aperture shut
*exposure_theoretical_minimum=ushort(0); // [cnt]

// A real detector exposed to darkness for standard exposure time accumulates exposure_dark counts in each channel
// 20160908: actual values are not yet available so we use this guesstimate
*exposure_dark_guesstimate=ushort(10); // [cnt]

xps_img_max=xps_img.max($y,$x);
xps_img_max@long_name="Maximum image exposure at each wavelength";
xps_img_max@units="Counts on scale from 0 to 2^16-1 = 65535";

// [cnt] Exposure from spectralon reference target
//xps_rfr[wavelength,x]=exposure_reference_guesstimate; // Produces reflectances too small by ~10^5
xps_rfr[wavelength,x]=ushort(xps_img_max*(factory_calibrated_reflectance_guesstimate/maximum_plant_reflectance_guesstimate));
xps_rfr@long_name="Exposure from spectralon reference target";
xps_rfr@units="Counts on scale from 0 to 2^16-1 = 65535";

xps_img_min=xps_img.min($y,$x);
xps_img_min@long_name="Minimum image exposure at each wavelength";
xps_img_min@units="Counts on scale from 0 to 2^16-1 = 65535";

// [cnt] Exposure from dark current image
xps_drk[wavelength,x]=xps_img_min*0.01;
xps_drk@long_name="Exposure from dark current image";
xps_drk@units="Counts on scale from 0 to 2^16-1 = 65535";

// [frc] Reflectance of spectralon reference target (from factory calibration)
// 20160908: fxm track this down, possibly add angular dependence...
rfl_rfr_fct[wavelength]=factory_calibrated_reflectance_guesstimate;
rfl_rfr_fct@long_name="Reflectance of Spectralon reference target (from factory calibration)";
rfl_rfr_fct@units="1";

// [cnt/cnt] Proportionality constant between factory-calibrated reflectance and current image and field calibration
// 20160908: No real reason to use or archive this
//rfl_img_prp=(xps_img-xps_drk)/(xps_rfr-xps_drk);

// [frc] = Reflectance of image (plant reflectance)
// 20160826: Pre-assigning to zero would create additional copy and increase required memory
// Instead use implicit casting, and overwrite attributes propagated from rfl_rfr_fct
//rfl_img[wavelength,y,x]=0.0f;
rfl_img=rfl_rfr_fct*(xps_img-xps_drk)/(xps_rfr-xps_drk);
rfl_img@long_name="Reflectance of image";
rfl_img@standard_name="surface_albedo";
rfl_img@units="1";
  
/* 20160908: 
   Below this line is Environmental Logger information, now extraneous to hyperspectral calibration
   New calibration algorithm does not depend on measured irradiance...yet 
   We could move this Environmental Logger code to (ncap2 version of) EL extractor */
// [nbr] Number of wavelengths in environmental sensor
*wvl_nvr_nbr=1024;
defdim("wvl_nvr",wvl_nvr_nbr);
wvl_nvr[wvl_nvr]=0.0f; // [m]
wvl_nvr@long_name="Wavelength of environmental sensor";
wvl_nvr@standard_name="sensor_band_central_radiation_wavelength";
wvl_nvr@units="meter";
wvl_nvr@provenance="EnvironmentalLogger calibration information from file S05673_08062015.IrradCal provided by TinoDornbusch and discussed here: https://github.com/terraref/reference-data/issues/30#issuecomment-217518434";

wvl_nvr={ // [nm] 10 wavelengths per line, 1024 total
337.70,338.16,338.62,339.07,339.53,339.98,340.44,340.89,341.35,341.80,
342.26,342.72,343.17,343.63,344.08,344.54,344.99,345.45,345.91,346.36,
346.82,347.28,347.73,348.19,348.64,349.10,349.56,350.01,350.47,350.93,
351.38,351.84,352.30,352.75,353.21,353.67,354.12,354.58,355.04,355.49,
355.95,356.41,356.86,357.32,357.78,358.23,358.69,359.15,359.61,360.06,
360.52,360.98,361.44,361.89,362.35,362.81,363.27,363.72,364.18,364.64,
365.10,365.55,366.01,366.47,366.93,367.39,367.84,368.30,368.76,369.22,
369.68,370.13,370.59,371.05,371.51,371.97,372.43,372.88,373.34,373.80,
374.26,374.72,375.18,375.64,376.09,376.55,377.01,377.47,377.93,378.39,
378.85,379.31,379.77,380.23,380.68,381.14,381.60,382.06,382.52,382.98,
383.44,383.90,384.36,384.82,385.28,385.74,386.20,386.66,387.12,387.58,
388.04,388.50,388.96,389.42,389.88,390.34,390.80,391.26,391.72,392.18,
392.64,393.10,393.56,394.02,394.48,394.94,395.40,395.86,396.32,396.78,
397.24,397.70,398.16,398.62,399.08,399.54,400.01,400.47,400.93,401.39,
401.85,402.31,402.77,403.23,403.69,404.16,404.62,405.08,405.54,406.00,
406.46,406.92,407.38,407.85,408.31,408.77,409.23,409.69,410.15,410.62,
411.08,411.54,412.00,412.46,412.93,413.39,413.85,414.31,414.77,415.24,
415.70,416.16,416.62,417.09,417.55,418.01,418.47,418.94,419.40,419.86,
420.32,420.79,421.25,421.71,422.17,422.64,423.10,423.56,424.03,424.49,
424.95,425.42,425.88,426.34,426.80,427.27,427.73,428.19,428.66,429.12,
429.58,430.05,430.51,430.98,431.44,431.90,432.37,432.83,433.29,433.76,
434.22,434.69,435.15,435.61,436.08,436.54,437.01,437.47,437.93,438.40,
438.86,439.33,439.79,440.25,440.72,441.18,441.65,442.11,442.58,443.04,
443.51,443.97,444.44,444.90,445.37,445.83,446.30,446.76,447.23,447.69,
448.16,448.62,449.09,449.55,450.02,450.48,450.95,451.41,451.88,452.34,
452.81,453.27,453.74,454.20,454.67,455.14,455.60,456.07,456.53,457.00,
457.46,457.93,458.40,458.86,459.33,459.79,460.26,460.73,461.19,461.66,
462.13,462.59,463.06,463.52,463.99,464.46,464.92,465.39,465.86,466.32,
466.79,467.26,467.72,468.19,468.66,469.12,469.59,470.06,470.52,470.99,
471.46,471.93,472.39,472.86,473.33,473.79,474.26,474.73,475.20,475.66,
476.13,476.60,477.07,477.53,478.00,478.47,478.94,479.40,479.87,480.34,
480.81,481.28,481.74,482.21,482.68,483.15,483.62,484.08,484.55,485.02,
485.49,485.96,486.42,486.89,487.36,487.83,488.30,488.77,489.23,489.70,
490.17,490.64,491.11,491.58,492.05,492.52,492.98,493.45,493.92,494.39,
494.86,495.33,495.80,496.27,496.74,497.21,497.68,498.14,498.61,499.08,
499.55,500.02,500.49,500.96,501.43,501.90,502.37,502.84,503.31,503.78,
504.25,504.72,505.19,505.66,506.13,506.60,507.07,507.54,508.01,508.48,
508.95,509.42,509.89,510.36,510.83,511.30,511.77,512.24,512.71,513.18,
513.65,514.12,514.59,515.06,515.54,516.01,516.48,516.95,517.42,517.89,
518.36,518.83,519.30,519.77,520.24,520.72,521.19,521.66,522.13,522.60,
523.07,523.54,524.01,524.49,524.96,525.43,525.90,526.37,526.84,527.32,
527.79,528.26,528.73,529.20,529.67,530.15,530.62,531.09,531.56,532.03,
532.51,532.98,533.45,533.92,534.40,534.87,535.34,535.81,536.29,536.76,
537.23,537.70,538.18,538.65,539.12,539.59,540.07,540.54,541.01,541.48,
541.96,542.43,542.90,543.38,543.85,544.32,544.80,545.27,545.74,546.22,
546.69,547.16,547.64,548.11,548.58,549.06,549.53,550.00,550.48,550.95,
551.42,551.90,552.37,552.84,553.32,553.79,554.27,554.74,555.21,555.69,
556.16,556.64,557.11,557.58,558.06,558.53,559.01,559.48,559.96,560.43,
560.90,561.38,561.85,562.33,562.80,563.28,563.75,564.23,564.70,565.18,
565.65,566.13,566.60,567.08,567.55,568.03,568.50,568.98,569.45,569.93,
570.40,570.88,571.35,571.83,572.30,572.78,573.25,573.73,574.20,574.68,
575.16,575.63,576.11,576.58,577.06,577.53,578.01,578.49,578.96,579.44,
579.91,580.39,580.87,581.34,581.82,582.29,582.77,583.25,583.72,584.20,
584.67,585.15,585.63,586.10,586.58,587.06,587.53,588.01,588.49,588.96,
589.44,589.92,590.39,590.87,591.35,591.82,592.30,592.78,593.26,593.73,
594.21,594.69,595.16,595.64,596.12,596.60,597.07,597.55,598.03,598.50,
598.98,599.46,599.94,600.41,600.89,601.37,601.85,602.33,602.80,603.28,
603.76,604.24,604.71,605.19,605.67,606.15,606.63,607.10,607.58,608.06,
608.54,609.02,609.50,609.97,610.45,610.93,611.41,611.89,612.37,612.85,
613.32,613.80,614.28,614.76,615.24,615.72,616.20,616.67,617.15,617.63,
618.11,618.59,619.07,619.55,620.03,620.51,620.99,621.47,621.94,622.42,
622.90,623.38,623.86,624.34,624.82,625.30,625.78,626.26,626.74,627.22,
627.70,628.18,628.66,629.14,629.62,630.10,630.58,631.06,631.54,632.02,
632.50,632.98,633.46,633.94,634.42,634.90,635.38,635.86,636.34,636.82,
637.30,637.78,638.26,638.74,639.22,639.70,640.18,640.67,641.15,641.63,
642.11,642.59,643.07,643.55,644.03,644.51,644.99,645.47,645.96,646.44,
646.92,647.40,647.88,648.36,648.84,649.32,649.81,650.29,650.77,651.25,
651.73,652.21,652.70,653.18,653.66,654.14,654.62,655.10,655.59,656.07,
656.55,657.03,657.51,658.00,658.48,658.96,659.44,659.92,660.41,660.89,
661.37,661.85,662.34,662.82,663.30,663.78,664.27,664.75,665.23,665.71,
666.20,666.68,667.16,667.64,668.13,668.61,669.09,669.58,670.06,670.54,
671.03,671.51,671.99,672.47,672.96,673.44,673.92,674.41,674.89,675.37,
675.86,676.34,676.82,677.31,677.79,678.28,678.76,679.24,679.73,680.21,
680.69,681.18,681.66,682.15,682.63,683.11,683.60,684.08,684.57,685.05,
685.53,686.02,686.50,686.99,687.47,687.95,688.44,688.92,689.41,689.89,
690.38,690.86,691.35,691.83,692.32,692.80,693.28,693.77,694.25,694.74,
695.22,695.71,696.19,696.68,697.16,697.65,698.13,698.62,699.10,699.59,
700.07,700.56,701.05,701.53,702.02,702.50,702.99,703.47,703.96,704.44,
704.93,705.41,705.90,706.39,706.87,707.36,707.84,708.33,708.81,709.30,
709.79,710.27,710.76,711.24,711.73,712.22,712.70,713.19,713.68,714.16,
714.65,715.13,715.62,716.11,716.59,717.08,717.57,718.05,718.54,719.03,
719.51,720.00,720.49,720.97,721.46,721.95,722.43,722.92,723.41,723.90,
724.38,724.87,725.36,725.84,726.33,726.82,727.31,727.79,728.28,728.77,
729.25,729.74,730.23,730.72,731.20,731.69,732.18,732.67,733.16,733.64,
734.13,734.62,735.11,735.59,736.08,736.57,737.06,737.55,738.03,738.52,
739.01,739.50,739.99,740.47,740.96,741.45,741.94,742.43,742.92,743.40,
743.89,744.38,744.87,745.36,745.85,746.34,746.82,747.31,747.80,748.29,
748.78,749.27,749.76,750.25,750.74,751.22,751.71,752.20,752.69,753.18,
753.67,754.16,754.65,755.14,755.63,756.12,756.61,757.10,757.58,758.07,
758.56,759.05,759.54,760.03,760.52,761.01,761.50,761.99,762.48,762.97,
763.46,763.95,764.44,764.93,765.42,765.91,766.40,766.89,767.38,767.87,
768.36,768.85,769.34,769.83,770.32,770.81,771.30,771.79,772.28,772.78,
773.27,773.76,774.25,774.74,775.23,775.72,776.21,776.70,777.19,777.68,
778.17,778.66,779.16,779.65,780.14,780.63,781.12,781.61,782.10,782.59,
783.09,783.58,784.07,784.56,785.05,785.54,786.03,786.53,787.02,787.51,
788.00,788.49,788.98,789.48,789.97,790.46,790.95,791.44,791.93,792.43,
792.92,793.41,793.90,794.39,794.89,795.38,795.87,796.36,796.86,797.35,
797.84,798.33,798.82,799.32,799.81,800.30,800.79,801.29,801.78,802.27,
802.77,803.26,803.75,804.24,804.74,805.23,805.72,806.22,806.71,807.20,
807.69,808.19,808.68,809.17,809.67,810.16,810.65,811.15,811.64,812.13,
812.63,813.12,813.61,814.11,814.60,815.09,815.59,816.08,816.57,817.07,
817.56,818.06,818.55,819.04,819.54,820.03,820.53,821.02,821.51,822.01,
822.50,823.00,823.49,823.98};
// Change EnvironmentalLogger wavelengths from nm to m (SI)
wvl_nvr*=1.0e-9; // [m]

// Compute bandwidth as difference between midpoints of adjacent band-centers
wvl_dlt[wvl_nvr]=0.0f;
wvl_dlt@long_name="Bandwidth of environmental sensor";
wvl_dlt@units="meter";
wvl_dlt@standard_name="bandwidth";
wvl_dlt@notes="Bandwidth, also called dispersion, is between 0.455-0.495 nm across all channels. Values computed as differences between midpoints of adjacent band-centers.";
*idx=wvl_dlt.size()-1;
*wvl_lft[wvl_nvr]=0.0;
*wvl_rgt[wvl_nvr]=0.0;
wvl_lft(1:idx)=0.5*(wvl_nvr(0:idx-1)+wvl_nvr(1:idx));
wvl_rgt(0:idx-1)=wvl_lft(1:idx);
wvl_lft(0)=wvl_nvr(0)-0.5*(wvl_nvr(1)-wvl_nvr(0));
wvl_rgt(idx)=wvl_nvr(idx)+0.5*(wvl_nvr(idx)-wvl_nvr(idx-1));
wvl_dlt=wvl_rgt-wvl_lft;

flx_sns[wvl_nvr]=0.0f;
flx_sns@long_name="Flux sensitivity of each band (irradiance per count)";
flx_sns@units="joule count-1";
flx_sns@provenance="EnvironmentalLogger calibration information from file S05673_08062015.IrradCal provided by TinoDornbusch and discussed here: https://github.com/terraref/reference-data/issues/30#issuecomment-217518434";
flx_sns={ // [uJ cnt-1] 10 sensitivities per line, 1024 total
2.14905162e-3,2.14905162e-3,2.13191329e-3,2.09958721e-3,2.07255014e-3,2.04042869e-3,2.01065201e-3,1.98247712e-3,1.95695595e-3,1.93084270e-3,
1.90570597e-3,1.87482001e-3,1.85556117e-3,1.83111292e-3,1.80493827e-3,1.78204243e-3,1.76011709e-3,1.74298970e-3,1.72493868e-3,1.70343113e-3,
1.68553722e-3,1.66631622e-3,1.65443041e-3,1.63642311e-3,1.61846215e-3,1.60545573e-3,1.59131286e-3,1.57713520e-3,1.56105571e-3,1.54524417e-3,
1.53346351e-3,1.51857527e-3,1.50523348e-3,1.49241475e-3,1.47961893e-3,1.46809459e-3,1.45371019e-3,1.44115770e-3,1.42656173e-3,1.41449893e-3,
1.40218325e-3,1.38727829e-3,1.37516400e-3,1.36250816e-3,1.34930545e-3,1.33658553e-3,1.32360948e-3,1.31037104e-3,1.29485640e-3,1.28218362e-3,
1.26643446e-3,1.25134745e-3,1.23774104e-3,1.22154062e-3,1.20610594e-3,1.19103569e-3,1.17634593e-3,1.16196432e-3,1.14706609e-3,1.13382928e-3,
1.11918389e-3,1.10556178e-3,1.09188557e-3,1.07918790e-3,1.06742601e-3,1.05718118e-3,1.04694473e-3,1.03659582e-3,1.02873900e-3,1.02288609e-3,
1.01628109e-3,1.01158157e-3,1.00762812e-3,1.00491506e-3,9.99889414e-4,9.95638736e-4,9.91223764e-4,9.86536043e-4,9.82378851e-4,9.75992983e-4,
9.68055921e-4,9.60360601e-4,9.52229616e-4,9.44288731e-4,9.35551583e-4,9.27778978e-4,9.19234295e-4,9.10434775e-4,9.02072493e-4,8.94082691e-4,
8.86054070e-4,8.80176269e-4,8.73884929e-4,8.67741565e-4,8.61294713e-4,8.55225782e-4,8.50034434e-4,8.44592095e-4,8.39026291e-4,8.32991645e-4,
8.27232672e-4,8.20422797e-4,8.12627476e-4,8.03944155e-4,7.93686106e-4,7.82697718e-4,7.71489658e-4,7.58484857e-4,7.47988099e-4,7.37636214e-4,
7.28366631e-4,7.19162810e-4,7.11125553e-4,7.03209565e-4,6.94909585e-4,6.86758690e-4,6.78942712e-4,6.70144668e-4,6.62797996e-4,6.54343779e-4,
6.46170305e-4,6.38872127e-4,6.30959379e-4,6.25264821e-4,6.19260059e-4,6.14223740e-4,6.09600378e-4,6.04109797e-4,5.99684341e-4,5.94762462e-4,
5.89358438e-4,5.84542583e-4,5.79374467e-4,5.76250247e-4,5.72012513e-4,5.68631187e-4,5.65821491e-4,5.62718648e-4,5.59116033e-4,5.55411029e-4,
5.51801247e-4,5.47598043e-4,5.43247327e-4,5.37762461e-4,5.33460619e-4,5.28878572e-4,5.23689536e-4,5.19266009e-4,5.14458405e-4,5.10751276e-4,
5.07003427e-4,5.03165882e-4,4.98966826e-4,4.96001001e-4,4.93715941e-4,4.90249980e-4,4.86771807e-4,4.83624709e-4,4.80476687e-4,4.76929878e-4,
4.74001018e-4,4.70608674e-4,4.66770209e-4,4.64581056e-4,4.61759438e-4,4.59189259e-4,4.57332260e-4,4.55348303e-4,4.53789335e-4,4.51997104e-4,
4.51229308e-4,4.49813718e-4,4.49043888e-4,4.48243809e-4,4.47227105e-4,4.45901662e-4,4.44320515e-4,4.42138136e-4,4.40911947e-4,4.38857020e-4,
4.36114912e-4,4.32791420e-4,4.29184734e-4,4.26039764e-4,4.23760025e-4,4.20638491e-4,4.17739943e-4,4.15334137e-4,4.13241033e-4,4.10672248e-4,
4.08480950e-4,4.07521131e-4,4.06620556e-4,4.05633162e-4,4.04394743e-4,4.02768826e-4,4.01579752e-4,4.00290096e-4,3.98392706e-4,3.96699174e-4,
3.94234388e-4,3.91851912e-4,3.89154416e-4,3.86231981e-4,3.83777232e-4,3.81168698e-4,3.78433645e-4,3.76298344e-4,3.74215227e-4,3.72197441e-4,
3.70207284e-4,3.68657365e-4,3.67545261e-4,3.66319403e-4,3.65206679e-4,3.63557693e-4,3.62294538e-4,3.61179418e-4,3.58947889e-4,3.56599608e-4,
3.53923148e-4,3.51224187e-4,3.48070600e-4,3.44364936e-4,3.40781769e-4,3.37471420e-4,3.33912295e-4,3.30235172e-4,3.26561393e-4,3.23282422e-4,
3.20050433e-4,3.17180477e-4,3.14219227e-4,3.11600742e-4,3.09493381e-4,3.07471257e-4,3.05484183e-4,3.03684277e-4,3.01998980e-4,3.00340107e-4,
2.98343918e-4,2.96867620e-4,2.94945050e-4,2.93219375e-4,2.91688135e-4,2.89922856e-4,2.87800025e-4,2.85461354e-4,2.83757039e-4,2.81377961e-4,
2.79552629e-4,2.77642310e-4,2.75503391e-4,2.73875335e-4,2.72347155e-4,2.70900748e-4,2.69293738e-4,2.67858074e-4,2.66460300e-4,2.65251110e-4,
2.64275292e-4,2.63248240e-4,2.62327379e-4,2.61579696e-4,2.60818456e-4,2.60002965e-4,2.58705340e-4,2.57752670e-4,2.56913992e-4,2.56361785e-4,
2.55265269e-4,2.54289030e-4,2.53369783e-4,2.52709129e-4,2.51737103e-4,2.50397300e-4,2.48911620e-4,2.47940106e-4,2.46958831e-4,2.46000402e-4,
2.44657610e-4,2.42959871e-4,2.41646677e-4,2.40071179e-4,2.38572274e-4,2.37125904e-4,2.35921992e-4,2.34980504e-4,2.34028683e-4,2.32572352e-4,
2.31160035e-4,2.29885626e-4,2.28995291e-4,2.28016467e-4,2.26725040e-4,2.25484801e-4,2.23893466e-4,2.22942513e-4,2.21397987e-4,2.19729430e-4,
2.18184785e-4,2.16237560e-4,2.14867776e-4,2.13119570e-4,2.11095792e-4,2.09431424e-4,2.07369328e-4,2.05197478e-4,2.02992714e-4,2.00995783e-4,
1.99040628e-4,1.97330365e-4,1.95128937e-4,1.92897050e-4,1.90828812e-4,1.88848992e-4,1.86812770e-4,1.85107403e-4,1.83851878e-4,1.81970227e-4,
1.80471463e-4,1.78981517e-4,1.77286120e-4,1.76392581e-4,1.75098596e-4,1.74137351e-4,1.73190515e-4,1.72166132e-4,1.71231374e-4,1.70366007e-4,
1.69568760e-4,1.68589267e-4,1.67791363e-4,1.66897578e-4,1.65888439e-4,1.65083935e-4,1.64157795e-4,1.63088458e-4,1.62054638e-4,1.60921204e-4,
1.59597998e-4,1.58591166e-4,1.57448762e-4,1.55975979e-4,1.54945634e-4,1.53768607e-4,1.52490862e-4,1.51237859e-4,1.50099128e-4,1.49111429e-4,
1.47998498e-4,1.47145525e-4,1.46192385e-4,1.45307609e-4,1.44594903e-4,1.43689016e-4,1.42978840e-4,1.42385947e-4,1.41618642e-4,1.41296459e-4,
1.40736609e-4,1.40128598e-4,1.39496377e-4,1.38800776e-4,1.38248154e-4,1.37619848e-4,1.37121202e-4,1.36531523e-4,1.35719098e-4,1.35125606e-4,
1.34189288e-4,1.33450058e-4,1.32766920e-4,1.31885017e-4,1.31122573e-4,1.30328488e-4,1.29426836e-4,1.28660144e-4,1.27935543e-4,1.27252022e-4,
1.26480762e-4,1.25668248e-4,1.24922118e-4,1.24410907e-4,1.23808009e-4,1.23163911e-4,1.22517652e-4,1.21996101e-4,1.21426745e-4,1.20795188e-4,
1.20351946e-4,1.19824156e-4,1.19435754e-4,1.19034938e-4,1.18434743e-4,1.18058836e-4,1.17753346e-4,1.17341202e-4,1.17001634e-4,1.16538566e-4,
1.16315189e-4,1.16025052e-4,1.15877025e-4,1.15561180e-4,1.15133517e-4,1.14836326e-4,1.14582204e-4,1.14243860e-4,1.14197033e-4,1.13911263e-4,
1.13780203e-4,1.13241434e-4,1.12847757e-4,1.12518590e-4,1.12240191e-4,1.12090644e-4,1.11898539e-4,1.11697770e-4,1.11478439e-4,1.11055915e-4,
1.11038903e-4,1.10892821e-4,1.10844792e-4,1.10832493e-4,1.10685454e-4,1.10585787e-4,1.10523459e-4,1.10538204e-4,1.10352101e-4,1.10342922e-4,
1.10281513e-4,1.10136790e-4,1.10034253e-4,1.10161106e-4,1.10100572e-4,1.10110098e-4,1.10080592e-4,1.09984173e-4,1.09845052e-4,1.09851854e-4,
1.09905915e-4,1.10028217e-4,1.10035987e-4,1.09960749e-4,1.09766410e-4,1.09785602e-4,1.09799006e-4,1.09935387e-4,1.09996957e-4,1.10015594e-4,
1.09970966e-4,1.09805155e-4,1.09719944e-4,1.09678392e-4,1.09725399e-4,1.09808313e-4,1.09636200e-4,1.09535133e-4,1.09295215e-4,1.09169349e-4,
1.09191375e-4,1.09233527e-4,1.09205113e-4,1.09120552e-4,1.09119671e-4,1.08973612e-4,1.08924114e-4,1.08891026e-4,1.08907229e-4,1.08986240e-4,
1.08900531e-4,1.08753082e-4,1.08703896e-4,1.08787039e-4,1.08795093e-4,1.08699656e-4,1.08837754e-4,1.08804051e-4,1.08825203e-4,1.08836245e-4,
1.08750606e-4,1.08911309e-4,1.08993157e-4,1.09019453e-4,1.08906882e-4,1.08830389e-4,1.08786024e-4,1.08648784e-4,1.08543831e-4,1.08526696e-4,
1.08346842e-4,1.08177325e-4,1.07894351e-4,1.07585013e-4,1.07355722e-4,1.07161797e-4,1.07018269e-4,1.06701081e-4,1.06490135e-4,1.06148921e-4,
1.05780669e-4,1.05519970e-4,1.05237804e-4,1.05018149e-4,1.04960672e-4,1.04759539e-4,1.04540409e-4,1.04335532e-4,1.04248329e-4,1.04080729e-4,
1.04091425e-4,1.04055083e-4,1.04023531e-4,1.03982955e-4,1.03897792e-4,1.03664565e-4,1.03597003e-4,1.03534202e-4,1.03538706e-4,1.03610086e-4,
1.03562393e-4,1.03382849e-4,1.03208570e-4,1.03080933e-4,1.03024256e-4,1.03051061e-4,1.03046453e-4,1.02968720e-4,1.02813488e-4,1.02603014e-4,
1.02234419e-4,1.02028022e-4,1.01905582e-4,1.01804529e-4,1.01678913e-4,1.01525915e-4,1.01235735e-4,1.01002510e-4,1.00753430e-4,1.00514078e-4,
1.00437680e-4,1.00426425e-4,1.00342652e-4,1.00324563e-4,1.00193735e-4,9.99614188e-5,9.97959450e-5,9.96635685e-5,9.95680633e-5,9.95295601e-5,
9.95419478e-5,9.93610409e-5,9.92005015e-5,9.89874238e-5,9.87621992e-5,9.86741797e-5,9.86446806e-5,9.87023188e-5,9.86904988e-5,9.87196887e-5,
9.86048564e-5,9.84391907e-5,9.83676057e-5,9.83207848e-5,9.84386405e-5,9.84955583e-5,9.85247638e-5,9.85229229e-5,9.84406010e-5,9.83803668e-5,
9.83439478e-5,9.83296520e-5,9.84439321e-5,9.85235870e-5,9.85655663e-5,9.84966496e-5,9.84488197e-5,9.84056559e-5,9.83206327e-5,9.81939782e-5,
9.83002829e-5,9.82246562e-5,9.82700124e-5,9.83010388e-5,9.82759501e-5,9.81680327e-5,9.80868465e-5,9.80081521e-5,9.80084773e-5,9.80201149e-5,
9.81387400e-5,9.80116911e-5,9.80144351e-5,9.79589533e-5,9.78046061e-5,9.76346492e-5,9.76720556e-5,9.76000615e-5,9.76940237e-5,9.76700649e-5,
9.76436554e-5,9.76217315e-5,9.75644547e-5,9.74582521e-5,9.73723677e-5,9.75158846e-5,9.76063227e-5,9.76576561e-5,9.78378613e-5,9.78764318e-5,
9.78355668e-5,9.79053556e-5,9.78971200e-5,9.79906854e-5,9.80966670e-5,9.83212609e-5,9.83661316e-5,9.85426549e-5,9.86024674e-5,9.86590075e-5,
9.86276988e-5,9.87354712e-5,9.87754605e-5,9.89135932e-5,9.91850242e-5,9.94027993e-5,9.94630471e-5,9.95331627e-5,9.95927355e-5,9.96449255e-5,
9.96738155e-5,9.97903713e-5,9.99867011e-5,1.00180641e-4,1.00305263e-4,1.00350675e-4,1.00337790e-4,1.00368296e-4,1.00386643e-4,1.00381686e-4,
1.00519126e-4,1.00708351e-4,1.00900376e-4,1.00985285e-4,1.01155946e-4,1.01232434e-4,1.01246029e-4,1.01294137e-4,1.01423141e-4,1.01638838e-4,
1.01812099e-4,1.01937894e-4,1.02167422e-4,1.02253729e-4,1.02424793e-4,1.02521930e-4,1.02690121e-4,1.02839311e-4,1.03089113e-4,1.03250475e-4,
1.03431580e-4,1.03716033e-4,1.03938607e-4,1.04117939e-4,1.04384106e-4,1.04529677e-4,1.04654582e-4,1.04814310e-4,1.05092692e-4,1.05413737e-4,
1.05740355e-4,1.06083661e-4,1.06308365e-4,1.06565438e-4,1.06629335e-4,1.06744210e-4,1.06882442e-4,1.07187881e-4,1.07381175e-4,1.07571985e-4,
1.07752337e-4,1.07958784e-4,1.08010861e-4,1.08075778e-4,1.08124883e-4,1.08257449e-4,1.08419171e-4,1.08593318e-4,1.08694174e-4,1.08884465e-4,
1.09042040e-4,1.09206302e-4,1.09350437e-4,1.09438760e-4,1.09607358e-4,1.09782787e-4,1.09955758e-4,1.10091358e-4,1.10285940e-4,1.10491229e-4,
1.10742419e-4,1.10907433e-4,1.10989206e-4,1.10994674e-4,1.11224947e-4,1.11275260e-4,1.11379372e-4,1.11598462e-4,1.11899867e-4,1.12232203e-4,
1.12446731e-4,1.12641100e-4,1.12842223e-4,1.13075513e-4,1.13342586e-4,1.13508149e-4,1.13820379e-4,1.14203203e-4,1.14490663e-4,1.14760307e-4,
1.15092754e-4,1.15469416e-4,1.15670149e-4,1.16009156e-4,1.16271820e-4,1.16580050e-4,1.16902429e-4,1.17308313e-4,1.17666409e-4,1.18021025e-4,
1.18417002e-4,1.18680029e-4,1.18865319e-4,1.19262047e-4,1.19437496e-4,1.19686615e-4,1.19978762e-4,1.20252739e-4,1.20473473e-4,1.20770056e-4,
1.21090033e-4,1.21331608e-4,1.21505469e-4,1.21699316e-4,1.21782412e-4,1.21974020e-4,1.22103237e-4,1.22231939e-4,1.22420471e-4,1.22581870e-4,
1.22711136e-4,1.22866496e-4,1.22913279e-4,1.23115711e-4,1.23199889e-4,1.23323819e-4,1.23461205e-4,1.23642315e-4,1.23796507e-4,1.24020468e-4,
1.24238753e-4,1.24422114e-4,1.24625589e-4,1.24860150e-4,1.24989076e-4,1.25232771e-4,1.25461347e-4,1.25751417e-4,1.26039690e-4,1.26363122e-4,
1.26586473e-4,1.26874300e-4,1.27211480e-4,1.27449080e-4,1.27810195e-4,1.28112243e-4,1.28496922e-4,1.28769318e-4,1.28988874e-4,1.29308334e-4,
1.29681533e-4,1.30081273e-4,1.30484797e-4,1.30834377e-4,1.31195470e-4,1.31542514e-4,1.31971306e-4,1.32327207e-4,1.32671516e-4,1.33163904e-4,
1.33602896e-4,1.34007504e-4,1.34403545e-4,1.34785880e-4,1.35232311e-4,1.35920055e-4,1.36371634e-4,1.36941354e-4,1.37497873e-4,1.38329979e-4,
1.38981090e-4,1.39719676e-4,1.40596483e-4,1.41573836e-4,1.42701064e-4,1.43912407e-4,1.45127755e-4,1.46710702e-4,1.48201619e-4,1.49963009e-4,
1.51809861e-4,1.53750193e-4,1.55815317e-4,1.57693897e-4,1.59629003e-4,1.61541153e-4,1.63306339e-4,1.64888939e-4,1.66286077e-4,1.67668695e-4,
1.68815611e-4,1.69629768e-4,1.70307707e-4,1.70592642e-4,1.70837390e-4,1.70905017e-4,1.70730284e-4,1.70560321e-4,1.70279811e-4,1.69980969e-4,
1.69683568e-4,1.69203059e-4,1.68858534e-4,1.68509619e-4,1.68194840e-4,1.67681333e-4,1.67199028e-4,1.66717819e-4,1.66199767e-4,1.65735840e-4,
1.65420369e-4,1.65032314e-4,1.64890865e-4,1.64715724e-4,1.64497541e-4,1.64412240e-4,1.64324793e-4,1.64276994e-4,1.64155537e-4,1.64020542e-4,
1.64016963e-4,1.63898890e-4,1.64032362e-4,1.64045267e-4,1.64195414e-4,1.64285742e-4,1.64460407e-4,1.64661763e-4,1.64738587e-4,1.64862909e-4,
1.65076816e-4,1.65024997e-4,1.65162453e-4,1.65237474e-4,1.65562552e-4,1.65709225e-4,1.66142295e-4,1.66413982e-4,1.66803643e-4,1.67161297e-4,
1.67479188e-4,1.67667097e-4,1.67864791e-4,1.68139958e-4,1.68233347e-4,1.68368232e-4,1.68734109e-4,1.68895921e-4,1.69306212e-4,1.69651966e-4,
1.69946857e-4,1.70444809e-4,1.70732732e-4,1.71135157e-4,1.71231516e-4,1.71550211e-4,1.71696417e-4,1.71827084e-4,1.72142950e-4,1.72525391e-4,
1.72856514e-4,1.73390715e-4,1.73767822e-4,1.74328441e-4,1.74893554e-4,1.75395641e-4,1.75742115e-4,1.76164298e-4,1.76419331e-4,1.76746627e-4,
1.76913681e-4,1.77372254e-4,1.77897899e-4,1.78453513e-4,1.79169646e-4,1.79727818e-4,1.80409802e-4,1.81135436e-4,1.81693575e-4,1.82304987e-4,
1.82840211e-4,1.83218701e-4,1.83686875e-4,1.84158245e-4,1.84720710e-4,1.85261670e-4,1.86044882e-4,1.86910627e-4,1.87744111e-4,1.88640197e-4,
1.89536957e-4,1.90373887e-4,1.91044376e-4,1.91770554e-4,1.92334227e-4,1.93008156e-4,1.93752580e-4,1.94471581e-4,1.95272205e-4,1.96159946e-4,
1.97179878e-4,1.98147132e-4,1.99205315e-4,2.00512171e-4,2.01401775e-4,2.02350741e-4,2.03121965e-4,2.03880283e-4,2.04553652e-4,2.05224749e-4,
2.05896678e-4,2.06741041e-4,2.07620395e-4,2.08540576e-4,2.09373829e-4,2.10385794e-4,2.11266605e-4,2.12109107e-4,2.12682109e-4,2.13305338e-4,
2.13902214e-4,2.14484164e-4,2.14843762e-4,2.15242449e-4,2.15718844e-4,2.16421684e-4,2.17195290e-4,2.18005590e-4,2.18962077e-4,2.19991471e-4,
2.20919919e-4,2.21546974e-4,2.22053928e-4,2.22555080e-4,2.23237798e-4,2.23532485e-4,2.23996613e-4,2.24501430e-4,2.25173147e-4,2.25737767e-4,
2.26423767e-4,2.27365037e-4,2.28449699e-4,2.29400621e-4,2.30377333e-4,2.31057918e-4,2.31964152e-4,2.32623742e-4,2.33166196e-4,2.33650080e-4,
2.34105936e-4,2.34878659e-4,2.35394209e-4,2.36099367e-4,2.37123530e-4,2.38223666e-4,2.39309613e-4,2.40405595e-4,2.41495657e-4,2.42458496e-4,
2.43313474e-4,2.44175726e-4,2.44734401e-4,2.45486851e-4,2.45993980e-4,2.46800743e-4,2.47463201e-4,2.48445219e-4,2.49488279e-4,2.50569021e-4,
2.51747840e-4,2.52951109e-4,2.54188859e-4,2.55386833e-4,2.56298369e-4,2.57479006e-4,2.58213101e-4,2.59065147e-4,2.60018887e-4,2.61076885e-4,
2.62283407e-4,2.63904910e-4,2.65792030e-4,2.67956880e-4,2.70494493e-4,2.73225853e-4,2.76170072e-4,2.79055057e-4,2.81984548e-4,2.88500954e-4,
2.89109910e-4,2.93129400e-4,2.92536512e-4,2.92536512e-4};
// Change flux sensitivity from [uJ cnt-1] to [J cnt-1] (SI)
flx_sns*=1.0e-6; // [J cnt-1]

if(0){
  // Old ncap2 script that converted GDAL-prodoced rasters into a single 3D image cube
  if(!exists(wvl_nbr)) *wvl_nbr=926; // [nbr] SWIR camera has 926 bands

  defdim("wavelength",wvl_nbr); 
  exposure[wavelength,x,y]=0.0f; 
  exposure@long_name="Fractional exposure";
  exposure@meaning="Ratio of actual to fully exposed (saturated) channel";
  exposure@units="fraction";
  set_miss(exposure,Band1@_FillValue);
  wavelength[wavelength]=0.0f;
  wavelength@long_name="Wavelength";
  wavelength@units="nanometer";
  
  for(*wvl_idx=1;wvl_idx<=wvl_nbr;wvl_idx++){
    // Current variable has name produced by gdal_translate
    @var_crr=snprint(wvl_idx,"Band%d"); 
    @att_crr=snprint(wvl_idx,"Band%d@wavelength"); 
    if(flg_typ == flg_tst) print(@var_crr,"%s ");
    
    // Copy band 2D raster into 3D image hypercube
    exposure((wvl_idx-1),:,:)=*@var_crr;   
    
    // Copy wavelength attribute into wavelength coordinate
    wavelength(wvl_idx-1)=*@att_crr;
 } // !wvl_idx

  // Debugging sanity check: Ensure, e.g., Band10 minus tenth band is zero
  if(flg_typ == flg_tst){
    err_chk10=(Band10-exposure(9,:,:)).total();
    err_chk300=(Band300-exposure(299,:,:)).total();
    err_chk926=(Band926-exposure(925,:,:)).total();
    print(err_chk10);
    print(err_chk300);
    print(err_chk926);
  } // !flg_typ
  
} // !0

